{"files":[{"id":"6c468ab2-0874-446e-895e-563ac8adeffc","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Indiana/Indianapolis\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"yuytuytu\",\n      \"functionName\": \"yuytuytu\"\n    }, {\n      \"menuName\": \"NEW_CASES\",\n      \"functionName\": \"NEW_CASES\"\n    }]\n  }\n}"},{"id":"61e1621c-b35b-4440-99fb-dcefcabf4a0a","name":"macros","type":"server_js","source":"function DIREC_MODELOS()\n { var ENL\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027ENLACES\u0027)\n   var D_ENL\u003dENL.getDataRange().getValues() \n\n   var GLOBAL\u003dSpreadsheetApp.openById(\"14AazFE4VOZZoRE-DQt_YOIgbQaZLQEPt95cRZfO3KYk\").getSheetByName(\u0027GLOBAL\u0027)\n   var D_GLOBAL\u003dGLOBAL.getDataRange().getValues()\n\n   Logger.log(D_GLOBAL.length)\n\n   var L\u003dD_ENL.length -1\n\n   for(i\u003d1;i\u003c\u003dL;i++)\n   { \n     var MODELO\u003dD_ENL[i][0]\n     var ENLACE\u003dD_ENL[i][1]\n     \n     var REP\u003dSpreadsheetApp.openById(ENLACE).getSheets()[0]\n     var Ult\u003dREP.getDataRange().getLastRow()\n     var U_U\u003dREP.getRange(\u0027F\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()\n     var UU\u003dREP.getRange(\u0027F\u0027+U_U).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()+1\n\n     Logger.log(UU)\n     var ST_REP\u003dREP.getRange(\u0027F:F\u0027).getValues().join()\n\n     Logger.log(ST_REP)\n    \n   if((MODELO\u003d\u003d\"SMARTPOS A920\")||(MODELO\u003d\u003d\"SMARTPOS A910\"))\n    { var Filtro\u003dD_GLOBAL.map(function (v,i){return [v[3],v[6],v[7],v[15],v[17],v[19],v[21],v[22],v[32],v[33],i+1,v[20],v[34],v[35]]}).filter(function (v){return v[1]\u003d\u003d\u003d\"REDEBAN MULTICOLOR S.A.\"\u0026\u0026v[4]\u003d\u003d\u003dMODELO\u0026\u0026v[8]!\u003d\u003d\"\"\u0026\u0026v[9]!\u003d\u003d\"\"\u0026\u0026ST_REP.toString().indexOf(v[0],0)\u003d\u003d\u003d-1})\n    }else{\nif(MODELO\u003d\u003d\"IMPRESORA RP4\")\n    { var Filtro\u003dD_GLOBAL.map(function (v,i){return [v[3],v[6],v[7],v[15],v[17],v[19],v[21],v[22],v[32],v[33],i+1,v[20],v[34],v[35]]}).filter(function (v){return v[1]\u003d\u003d\u003d\"OLIMPICA\"\u0026\u0026v[4]\u003d\u003d\u003dMODELO\u0026\u0026v[8]!\u003d\u003d\"\"\u0026\u0026v[9]!\u003d\u003d\"\"\u0026\u0026ST_REP.toString().indexOf(v[0],0)\u003d\u003d\u003d-1})\n    }\n\nelse{var Filtro\u003dD_GLOBAL.map(function (v,i){return [v[3],v[6],v[7],v[15],v[17],v[19],v[21],v[22],v[32],v[33],i+1,v[20],v[34],v[35]]}).filter(function (v){return v[4]\u003d\u003d\u003dMODELO\u0026\u0026v[8]!\u003d\u003d\"\"\u0026\u0026v[9]!\u003d\u003d\"\"\u0026\u0026ST_REP.toString().indexOf(v[0],0)\u003d\u003d\u003d-1})\n    Logger.log(Filtro)\n    }}\n    \n\n      var LL\u003dFiltro.length\n     if(LL\u003e0){REP.insertRowsBefore(U_U,L)}\n\n    for(j\u003d0;j\u003cFiltro.length;j++)\n    { \n      var Fecha\u003dFiltro[j][2]\n      var Sede\u003dFiltro[j][3]\n      var Cliente\u003dFiltro[j][1]\n      var Servicio\u003dFiltro[j][0]\n      var Serial\u003dFiltro[j][5]\n      var Falla\u003dFiltro[j][6]\n      var Acces\u003dFiltro[j][7]\n      var Diag\u003dFiltro[j][8]\n      var Repp\u003dFiltro[j][9]\n      var Marc\u003dFiltro[j][11]\n      var Gtia_Rep\u003dFiltro[j][12]\n      var Tip\u003dFiltro[j][13]\n      var Mod\u003dFiltro[j][4]\n\n      if((MODELO\u003d\u003d\"MPOS D190\")||(MODELO\u003d\u003d\"MPOS D200\")||(MODELO\u003d\u003d\"SMARTPOS A910\")||(MODELO\u003d\u003d\"SMARTPOS A920\")||(MODELO\u003d\u003d\"N86\"))\n      {var Index\u003dFalla.toString().indexOf(\u0027\u003d\u0027,0)\n       Falla\u003dFalla.toString().slice(0,Index)\n      }\n\n      REP.getRange(\u0027A\u0027+UU).setValue(Fecha)\n      REP.getRange(\u0027D\u0027+UU).setValue(Sede)\n      REP.getRange(\u0027E\u0027+UU).setValue(Cliente)\n      REP.getRange(\u0027F\u0027+UU).setValue(Servicio)\n      REP.getRange(\u0027G\u0027+UU).setValue(Serial)\n      REP.getRange(\u0027H\u0027+UU).setValue(Marc)\n      if((MODELO\u003d\u003d\"SMARTPOS A910\")||(MODELO\u003d\u003d\"SMARTPOS A920\")){REP.getRange(\u0027I\u0027+UU).setValue(Mod)}\n\n      REP.getRange(D_ENL[i][2]+UU).setValue(Falla)\n      REP.getRange(D_ENL[i][3]+UU).setValue(Acces)\n      REP.getRange(D_ENL[i][4]+UU).setValue(Diag)\n      REP.getRange(D_ENL[i][5]+UU).setValue(Repp)\n      REP.getRange(D_ENL[i][6]+UU).setValue(Gtia_Rep)\n      REP.getRange(D_ENL[i][7]+UU).setValue(Tip)\n\n      UU\u003dUU+1\n    }\n    //REP.getRange(\u00274:\u0027+UU).sort({column: 1, ascending: true})\n   }\n }\n\n\n"}]}