{"files":[{"id":"6de41477-6357-4c0b-9ca1-c78b60e9a0bc","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"NONE\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"d0fea718-76c9-4b9c-a342-14bbddf6b774","name":"Código","type":"server_js","source":"function ASIG(HT,TEC,SEDE,DB)\n{ var GLOBAL\u003dSpreadsheetApp.openById(\"14AazFE4VOZZoRE-DQt_YOIgbQaZLQEPt95cRZfO3KYk\").getSheetByName(\"GLOBAL\")\n  var D_GLOBAL\u003dGLOBAL.getRange(\u0027A:AX\u0027).getValues()\n  var D_DB\u003dDB.getDataRange().getValues()\n\n  var Filtro3\u003dD_GLOBAL.filter(function (v){return (v[0]\u003d\u003d\u003d\"ASIGNADO REVISIÓN\"\u0026\u0026v[29]\u003d\u003d\u003dTEC)||(v[0]\u003d\u003d\u003d\"ASIGNADO REPARACIÓN\"\u0026\u0026v[48]\u003d\u003d\u003dTEC)}).map(function (v,i){return [TEC,v[6],v[0],v[17],\"PENDIENTE\",v[3],v[19],v[21],v[5],v[25],v[26],v[27],v[28],v[34],\"\",\"\",\"\",\"\"]})\n\nfor(j\u003d0;j\u003cFiltro3.length;j++)\n{ var X_ST\u003dFiltro3[j][5]\n  var X_EST\u003dFiltro3[j][2]\n  \n  if(X_EST\u003d\u003d\"ASIGNADO REVISIÓN\"){\n  var Filtro4\u003dD_DB.filter(function (v){return v[6]\u003d\u003d\u003d\"Revisión\"\u0026\u0026v[9]\u003d\u003d\u003dX_ST\u0026\u0026v[13]!\u003d\u003d\"N/A\"})\n  }\n  if(X_EST\u003d\u003d\"ASIGNADO REPARACIÓN\"){\n  var Filtro4\u003dD_DB.filter(function (v){return v[6]\u003d\u003d\u003d\"Reparación\"\u0026\u0026v[9]\u003d\u003d\u003dX_ST\u0026\u0026v[14]!\u003d\u003d\"N/A\"})\n  }\n  \n  if(Filtro4.length\u003e0){Filtro3[j][17]\u003d\"ALV\"}\n}\n\nvar Filtro\u003dFiltro3.filter(function (v){return v[17]!\u003d\u003d\"ALV\"})\n\nvar L\u003dFiltro.length+1\n\nif(Filtro.length\u003e0)\n{\n  Filtro.forEach(function (v,i,A)\n      { if(v[12]\u003d\u003d\"CASO ANTERIOR NO APROBADO\"){A[i][4]\u003d\"CASO ANTERIOR NO APROBADO\"}\n      else{if(v[12]\u003d\u003d\"SI APLICA\"){A[i][4]\u003d\"REINGRESO\"}\n           else{if(v[9]\u003d\"VENCIDA\"){A[i][4]\u003d\"VENTA DE SERVICIO\"}\n              if(v[9]\u003d\"VIGENTE\"){\n              if(v[10]\u003d\u003d\"VENTA\"){A[i][4]\u003d\"GARANTIA\"}\n              if(v[10]\u003d\u003d\"ARRIENDO\"){A[i][4]\u003d\"ARRIENDO\"}}}\n              if(v[13]\u003d\u003d\"SI APLICA\"){A[i][4]\u003d\"GARANTIA DE REPARACIÓN\"}}\n        if(v[12]\u003d\u003d\"NO APLICA\")\n      { if(v[2]\u003d\u003d\"ASIGNADO REVISIÓN\"){A[i][15]\u003d\"N/A\";A[i][16]\u003d\"N/A\";A[i][2]\u003d\"Revisión\"}\n        if(v[2]\u003d\u003d\"ASIGNADO REPARACIÓN\"){A[i][14]\u003d\"N/A\";A[i][16]\u003d\"N/A\";A[i][2]\u003d\"Reparación\"}\n        } else{if(v[2]\u003d\u003d\"ASIGNADO REVISIÓN\"){A[i][15]\u003d\"N/A\";A[i][2]\u003d\"Revisión\"}\n        if(v[2]\u003d\u003d\"ASIGNADO REPARACIÓN\"){A[i][14]\u003d\"N/A\";A[i][2]\u003d\"Reparación\"}}\n        if((SEDE\u003d\u003d\"BOGOTÁ\")\u0026\u0026(v[8]\u003d\u003d\"\")){A[i][8]\u003d\"FALTA INFORMACIÓN\"}\n      })\n\n Filtro.forEach(function (v,i,A)\n {if(v[12]\u003d\u003d\"SI APLICA\")\n    { var SR\u003dv[6]\n      var Filtro2\u003dD_GLOBAL.filter(function (v){return v[19]\u003d\u003d\u003dSR}).map(function (v){return v[3]})\n      var M\u003dFiltro2.length\n      Filtro2.pop()\n      var S_Ant\u003dFiltro2.join()\n      if(SEDE\u003d\u003d\"BOGOTÁ\"){\n    if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nUBICACIÓN\u003d \"+v[8]+\"\\nCANT ING\u003d \"+M+\"\\nSERV ANT\u003d \"+S_Ant}}\n   else{if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nCANT ING\u003d \"+M+\"\\nSERV ANT\u003d \"+S_Ant}}}\n else\n {if(SEDE\u003d\u003d\"BOGOTÁ\")\n {if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nUBICACIÓN\u003d \"+v[8]}\n if(v[2]\u003d\u003d\"Reparación\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nUBICACIÓN\u003d \"+v[8]}}\n  else{if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]}\n  if(v[2]\u003d\u003d\"Reparación\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]}}}})\n\n  var CC\u003dFiltro.map(function (v){return [v[2],\"\",\"\",\"\",\"\",\"\"]})\n\n  CC.forEach(function (v,i,A){if(v[0]\u003d\u003d\"Revisión\"){A[i][0]\u003d\"#cfe2f3\";A[i][1]\u003d\"#cfe2f3\";A[i][2]\u003d\"#cfe2f3\";A[i][3]\u003d\"#cfe2f3\";A[i][4]\u003d\"#cfe2f3\";A[i][5]\u003d\"#cfe2f3\"}\n  if(v[0]\u003d\u003d\"Reparación\"){A[i][0]\u003d\"#fff2cc\";A[i][1]\u003d\"#fff2cc\";A[i][2]\u003d\"#fff2cc\";A[i][3]\u003d\"#fff2cc\";A[i][4]\u003d\"#fff2cc\";A[i][5]\u003d\"#fff2cc\"}})\n\n  HT.getRange(\u0027C2:H\u0027+L).setValues(Filtro.map(function (v){return [v[0],v[1],v[2],v[3],v[4],v[5]]}))\n  HT.getRange(\u0027C2:H\u0027+L).setBackgrounds(CC)\n  SpreadsheetApp.flush()\n  HT.getRange(\u0027H2:H\u0027+L).setNotes(Filtro.map(function (v){return [v[17]]}))\n  SpreadsheetApp.flush()\n  HT.getRange(\u0027M2:O\u0027+L).setValues(Filtro.map(function (v){return [v[14],v[15],v[16]]}))\n }\n}\n\nfunction ASIGv2(HT,DT,CT,TEC,SEDE,F,DB)\n{ var GLOBAL\u003dSpreadsheetApp.openById(\"14AazFE4VOZZoRE-DQt_YOIgbQaZLQEPt95cRZfO3KYk\").getSheetByName(\"GLOBAL\")\n  var D_GLOBAL\u003dGLOBAL.getRange(\u0027A:AX\u0027).getValues()\n  var D_DB\u003dDB.getDataRange().getValues()\n  //var REG\u003dSpreadsheetApp.openById(\"10QRzVRI76VWlRI8xKckjBympPjER-dejv-uwS8YsU5Q\").getSheetByName(\"BASE ACTIVIDADES\").getRange(\u0027H2:H\u0027).getValues()\n  //var D_REG\u003dREG.filter(function (v){return v[0].toString().indexOf(\"ST\",0)\u003e-1})\n  \n   for(i\u003d0;i\u003cF;i++)\n  { var ST\u003dDT[i][5]\n  var V\u003dST.toString().indexOf(\"ST\",0)\n    if(V\u003e-1){\n    var Color\u003dCT[i][2]\n    var TS\u003dDT[i][2]\n    if((TS\u003d\u003d\"Revisión\")||(TS\u003d\u003d\"Reparación\")){\n    var FiltroInt\u003dD_GLOBAL.filter(function (v,i){return v[3]\u003d\u003d\u003dST})\n    if((TS\u003d\u003d\"Revisión\")\u0026\u0026((FiltroInt[0][0]!\u003d\"ASIGNADO REVISIÓN\")||((FiltroInt[0][0]\u003d\u003d\"ASIGNADO REVISIÓN\")\u0026\u0026(FiltroInt[0][29]!\u003dTEC))))\n    { var A\u003di+2;HT.getRange(\u0027C\u0027+A+\u0027:H\u0027+A).setBackground(\u0027#b7b7b7\u0027)}\n    if((TS\u003d\u003d\"Reparación\")\u0026\u0026(Color!\u003d\"#d9ead3\")\u0026\u0026((FiltroInt[0][0]!\u003d\"ASIGNADO REPARACIÓN\")||((FiltroInt[0][0]\u003d\u003d\"ASIGNADO REPARACIÓN\")\u0026\u0026(FiltroInt[0][48]!\u003dTEC))))\n    {var A\u003di+2;HT.getRange(\u0027C\u0027+A+\u0027:H\u0027+A).setBackground(\u0027#b7b7b7\u0027)}\n    }\n   }\n  }\n   var JJ\u003dDT.map(function (v){return [v[5]]}).join()\n   //var KK\u003dD_REG.join()\n\n   var Filtro3\u003dD_GLOBAL.filter(function (v){return (v[0]\u003d\u003d\u003d\"ASIGNADO REVISIÓN\"\u0026\u0026v[29]\u003d\u003d\u003dTEC\u0026\u0026JJ.toString().indexOf(v[3],0)\u003d\u003d\u003d-1)||(v[0]\u003d\u003d\u003d\"ASIGNADO REPARACIÓN\"\u0026\u0026v[48]\u003d\u003d\u003dTEC\u0026\u0026JJ.toString().indexOf(v[3],0)\u003d\u003d\u003d-1)}).map(function (v,i){return [TEC,v[6],v[0],v[17],\"PENDIENTE\",v[3],v[19],v[21],v[5],v[25],v[26],v[27],v[28],v[34],\"\",\"\",\"\",\"\"]})\n\nfor(j\u003d0;j\u003cFiltro3.length;j++)\n{ var X_ST\u003dFiltro3[j][5]\n  var X_EST\u003dFiltro3[j][2]\n  \n  if(X_EST\u003d\u003d\"ASIGNADO REVISIÓN\"){\n  var Filtro4\u003dD_DB.filter(function (v){return v[6]\u003d\u003d\u003d\"Revisión\"\u0026\u0026v[9]\u003d\u003d\u003dX_ST\u0026\u0026v[13]!\u003d\u003d\"N/A\"})\n  }\n  if(X_EST\u003d\u003d\"ASIGNADO REPARACIÓN\"){\n  var Filtro4\u003dD_DB.filter(function (v){return v[6]\u003d\u003d\u003d\"Reparación\"\u0026\u0026v[9]\u003d\u003d\u003dX_ST\u0026\u0026v[14]!\u003d\u003d\"N/A\"})\n  }\n  \n  if(Filtro4.length\u003e0){Filtro3[j][17]\u003d\"ALV\"}\n}\n\nvar Filtro\u003dFiltro3.filter(function (v){return v[17]!\u003d\u003d\"ALV\"})\n\nvar L\u003dFiltro.length+1\n\nif(Filtro.length\u003e0)\n{\n  Filtro.forEach(function (v,i,A)\n      { if(v[12]\u003d\u003d\"CASO ANTERIOR NO APROBADO\"){A[i][4]\u003d\"CASO ANTERIOR NO APROBADO\"}\n      else{if(v[12]\u003d\u003d\"SI APLICA\"){A[i][4]\u003d\"REINGRESO\"}\n           else{if(v[9]\u003d\"VENCIDA\"){A[i][4]\u003d\"VENTA DE SERVICIO\"}\n              if(v[9]\u003d\"VIGENTE\"){\n              if(v[10]\u003d\u003d\"VENTA\"){A[i][4]\u003d\"GARANTIA\"}\n              if(v[10]\u003d\u003d\"ARRIENDO\"){A[i][4]\u003d\"ARRIENDO\"}}}\n              if(v[13]\u003d\u003d\"SI APLICA\"){A[i][4]\u003d\"GARANTIA DE REPARACIÓN\"}}\n        if(v[12]\u003d\u003d\"NO APLICA\")\n      { if(v[2]\u003d\u003d\"ASIGNADO REVISIÓN\"){A[i][15]\u003d\"N/A\";A[i][16]\u003d\"N/A\";A[i][2]\u003d\"Revisión\"}\n        if(v[2]\u003d\u003d\"ASIGNADO REPARACIÓN\"){A[i][14]\u003d\"N/A\";A[i][16]\u003d\"N/A\";A[i][2]\u003d\"Reparación\"}\n        } else{if(v[2]\u003d\u003d\"ASIGNADO REVISIÓN\"){A[i][15]\u003d\"N/A\";A[i][2]\u003d\"Revisión\"}\n        if(v[2]\u003d\u003d\"ASIGNADO REPARACIÓN\"){A[i][14]\u003d\"N/A\";A[i][2]\u003d\"Reparación\"}}\n        if((SEDE\u003d\u003d\"BOGOTÁ\")\u0026\u0026(v[8]\u003d\u003d\"\")){A[i][8]\u003d\"FALTA INFORMACIÓN\"}\n      })\n\n Filtro.forEach(function (v,i,A)\n {if(v[12]\u003d\u003d\"SI APLICA\")\n    { var SR\u003dv[6]\n      var Filtro2\u003dD_GLOBAL.filter(function (v){return v[19]\u003d\u003d\u003dSR}).map(function (v){return v[3]})\n      var M\u003dFiltro2.length\n      Filtro2.pop()\n      var S_Ant\u003dFiltro2.join()\n      if(SEDE\u003d\u003d\"BOGOTÁ\"){\n    if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nUBICACIÓN\u003d \"+v[8]+\"\\nCANT ING\u003d \"+M+\"\\nSERV ANT\u003d \"+S_Ant}}\n   else{if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nCANT ING\u003d \"+M+\"\\nSERV ANT\u003d \"+S_Ant}}}\n else\n {if(SEDE\u003d\u003d\"BOGOTÁ\")\n {if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]+\"\\nUBICACIÓN\u003d \"+v[8]}\n if(v[2]\u003d\u003d\"Reparación\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nUBICACIÓN\u003d \"+v[8]}}\n  else{if(v[2]\u003d\u003d\"Revisión\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]+\"\\nFALLA\u003d \"+v[7]}\n  if(v[2]\u003d\u003d\"Reparación\"){A[i][17]\u003d\"SERIAL\u003d \"+v[6]}}}})\n\n  var CC\u003dFiltro.map(function (v){return [v[2],\"\",\"\",\"\",\"\",\"\"]})\n\n  CC.forEach(function (v,i,A){if(v[0]\u003d\u003d\"Revisión\"){A[i][0]\u003d\"#cfe2f3\";A[i][1]\u003d\"#cfe2f3\";A[i][2]\u003d\"#cfe2f3\";A[i][3]\u003d\"#cfe2f3\";A[i][4]\u003d\"#cfe2f3\";A[i][5]\u003d\"#cfe2f3\"}\n  if(v[0]\u003d\u003d\"Reparación\"){A[i][0]\u003d\"#fff2cc\";A[i][1]\u003d\"#fff2cc\";A[i][2]\u003d\"#fff2cc\";A[i][3]\u003d\"#fff2cc\";A[i][4]\u003d\"#fff2cc\";A[i][5]\u003d\"#fff2cc\"}})\n\n  var N\u003dF+2\n  var K\u003dN+L-2\n\n  HT.getRange(\u0027C\u0027+N+\u0027:H\u0027+K).setValues(Filtro.map(function (v){return [v[0],v[1],v[2],v[3],v[4],v[5]]}))\n  HT.getRange(\u0027C\u0027+N+\u0027:H\u0027+K).setBackgrounds(CC)\n  SpreadsheetApp.flush()\n  HT.getRange(\u0027H\u0027+N+\u0027:H\u0027+K).setNotes(Filtro.map(function (v){return [v[17]]}))\n  SpreadsheetApp.flush()\n  HT.getRange(\u0027M\u0027+N+\u0027:O\u0027+K).setValues(Filtro.map(function (v){return [v[14],v[15],v[16]]}))\n}\n}\n\n\nfunction ONON(F,C,V,S,PP)\n{   if (((C \u003d\u003d 10) || (C \u003d\u003d 18)) \u0026\u0026 (PP !\u003d \"America/Bogota\")) {\n    SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(F, C, 1, 1).uncheck()\n    SpreadsheetApp.getActiveSpreadsheet().setSpreadsheetTimeZone(\"America/Bogota\")\n   } \n  //if((C\u003d\u003d18)\u0026\u0026(SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(\u0027S\u0027+F).getValue().toString().indexOf(\":\",1)\u003e-1)) { var M\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027DB\u0027).getDataRange().getLastRow()+1\n   // SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027DB\u0027).getRange(\u0027A\u0027+M+\u0027:B\u0027+M).setValues([[S,F]])}\n\n  //   if((C\u003d\u003d18)\u0026\u0026(V\u003d\u003d\"FALSE\")) \n  //  { //var IA\u003dF-1;var IP\u003dF+1\n  //  //SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRangeList([\u0027J1:J\u0027+IA,\u0027J\u0027+IP+\u0027:J\u0027]).uncheck()\n  //      var Hoja\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getDataRange().getValues()\n  //      var Filtro\u003dHoja.map(function (v,i){return v[9],v[10].valueOf(),v[17],v[18].valueOf(),i+1}).filter(function (v){return v[1]!\u003d\u003d\"\"\u0026\u0026v[3]\u003d\u003d\u003d\"\"})\n\n  //      //SpreadsheetApp.getActiveSpreadsheet().toast(Filtro.length,\u0027Prueba\u0027,6);\n\n  //  }\n    \n  if ((C \u003d\u003d 13) \u0026\u0026 (V !\u003d null)) {\n    var Rep \u003d V.toString().indexOf(\"ingun\", 0)\n    var HH\u003dSpreadsheetApp.getActiveSpreadsheet().getRange(\u0027K\u0027+F).getValue()\n    //SpreadsheetApp.getActiveSpreadsheet().toast(HH,\u0027Aviso\u0027,10);\n    if ((Rep \u003e -1)\u0026\u0026(HH.toString()!\u003d\"\")) {\n      var Data \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(F, 3, 1, 6).getValues()\n      Data[0][2] \u003d \"Reparación\"; Data[0][4] \u003d \"\";\n      var Ult \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getDataRange().getLastRow()\n      var U \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(\u0027C\u0027 + Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()+1\n      var Fnew\u003dF+1\n      if(F\u003d\u003dU-1){SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, 1, 6).setValues(Data).setBackground(\"#d9ead3\")}\n      else{\n      var DData\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getValues()\n      var DData2\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getBackgrounds()\n      var DData3\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getNotes()\n      var DData4\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 12, U-Fnew, 5).getValues()\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(\u0027P\u0027+F).setValue(\"LINEA SELLO\")\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setValues(DData)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setBackgrounds(DData2)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setNotes(DData3)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 12, U-Fnew, 5).setValues(DData4)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRangeList([\u0027C\u0027+Fnew+\u0027:I\u0027+Fnew,\u0027L\u0027+Fnew+\u0027:P\u0027+Fnew]).clearContent().clearNote()\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, 1, 6).setValues(Data).setBackground(\"#d9ead3\")\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRangeList([\u0027M\u0027+Fnew,\u0027O\u0027+Fnew+\u0027:P\u0027+Fnew]).setValue(\u0027N/A\u0027)\n    }}}\n\n    if ((C \u003d\u003d 16) \u0026\u0026 (V \u003d\u003d \"REPARADO\")) {\n      var HH\u003dSpreadsheetApp.getActiveSpreadsheet().getRange(\u0027K\u0027+F).getValue()\n      if(HH.toString()!\u003d\"\"){\n      var Data \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(F, 3, 1, 6).getValues()\n      Data[0][2] \u003d \"Reparación\"; Data[0][4] \u003d \"\";\n      var Ult \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getDataRange().getLastRow()\n      var U \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(\u0027C\u0027 + Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()+1\n      var Fnew\u003dF+1\n      if(F\u003d\u003dU-1){SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, 1, 6).setValues(Data).setBackground(\"#d9ead3\")}\n      else{\n      var DData\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getValues()\n      var DData2\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getBackgrounds()\n      var DData3\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, U-Fnew, 6).getNotes()\n      var DData4\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 12, U-Fnew, 5).getValues()\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setValues(DData)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setBackgrounds(DData2)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 3, U-Fnew, 6).setNotes(DData3)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew+1, 12, U-Fnew, 5).setValues(DData4)\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRangeList([\u0027C\u0027+Fnew+\u0027:I\u0027+Fnew,\u0027L\u0027+Fnew+\u0027:P\u0027+Fnew]).clearContent().clearNote()\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRange(Fnew, 3, 1, 6).setValues(Data).setBackground(\"#d9ead3\")\n      SpreadsheetApp.getActiveSpreadsheet().getSheetByName(S).getRangeList([\u0027M\u0027+Fnew,\u0027O\u0027+Fnew+\u0027:P\u0027+Fnew]).setValue(\u0027N/A\u0027)\n    }}}\n \n}\n\n function DB(DB,D_DB,ID)\n { var Filtro\u003dD_DB.map(function (v,i){return [v[0],v[1],i+1,v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15],v[16],v[17],v[18]]}).filter(function (v,i){return v[0]!\u003d\u003d\"\"\u0026\u0026v[2]\u003e1})\n   var L\u003dFiltro.length\n\n   if(L\u003e0)\n   { var Array1\u003d[...new Set(Filtro.map(function(v){return v[0]}))]\n     var H\u003dArray1.length\n   \n   for(j\u003d0;j\u003cH;j++)\n   {var Hoja\u003dArray1[j]\n    var Filtro2\u003dFiltro.filter(function (v){return v[0]\u003d\u003d\u003dHoja})\n    Filtro2.sort(function (a,b){return a[1]-b[1]})\n    var L2\u003dFiltro2.length-1\n\n    for(i\u003dL2;i\u003e\u003d0;i--)\n    { var Fila\u003dFiltro2[i][1]\n      var Index\u003dFiltro2[i][2]\n      var D_ACT\u003dSpreadsheetApp.openById(ID).getSheetByName(Hoja)\n      DB.getRange(\u0027A\u0027+Index+\u0027:B\u0027+Index).setValue(\"\")\n       DB.getRange(\u0027C\u0027+Index+\u0027:K\u0027+Index).setValues(D_ACT.getRange(\u0027A\u0027+Fila+\u0027:I\u0027+Fila).getValues())\n       DB.getRange(\u0027L\u0027+Index+\u0027:R\u0027+Index).setValues(D_ACT.getRange(\u0027K\u0027+Fila+\u0027:Q\u0027+Fila).getValues())\n       DB.getRange(\u0027S\u0027+Index).setValue(D_ACT.getRange(\u0027S\u0027+Fila).getValue())\n       D_ACT.deleteRow(Fila)\n      \n    }\n\n   }\n  }\n }\n\nfunction CLEAN(HT,C_HT)\n{ var Filtro\u003dC_HT.map(function(v,i){return [v[2],i+1]}).filter(function (v){return v[0]\u003d\u003d\u003d\u0027#b7b7b7\u0027})\n  if(Filtro.length\u003e0)\n  { for(j\u003dFiltro.length-1;j\u003e\u003d0;j--)\n    { var Index\u003dFiltro[j][1]\n    HT.getRange(Index+\u0027:\u0027+Index).setBackground(\u0027white\u0027)\n    HT.deleteRow(Index)\n    }\n  }\n}\n\nfunction MOVEACT(HT,DB)\n{ var D_HT\u003dHT.getDataRange().getValues()\n var Filtro\u003dD_HT.map(function (v,i){return [v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15],v[16],v[17],v[18],i+1]}).filter(function (v){return v[18]!\u003d\u003d\"\"\u0026\u0026v[19]\u003e1})\n\n  var L\u003dFiltro.length\n\n  for(i\u003dL-1;i\u003e\u003d0;i--)\n  { var Index\u003dFiltro[i][19]\n    var acum\u003d0\n    for(j\u003d0;j\u003c19;j++)\n    { var Cell\u003dFiltro[i][j]\n      if(j\u003d\u003d6){}\n    else{if((j\u003d\u003d9)||(j\u003d\u003d17)){if(Cell\u003d\u003d\u0027false\u0027){ acum\u003dacum+1}}\n         else{ if(Cell\u003d\u003d\"\"){ acum\u003dacum+1\n         HT.getRange(Index,j+1).setBackground(\u0027yellow\u0027)\n         }\n        }\n      }\n  }  \n    if(acum\u003d\u003d0)\n    {var Data\u003dFiltro[i]\n     Data.splice(19,1);Data.splice(17,1);Data.splice(9,1)\n\n      var II\u003dDB.getDataRange().getLastRow()+1\n      DB.getRange(\u0027C\u0027+II+\u0027:S\u0027+II).setValues([Data])\n      SpreadsheetApp.flush()\n      HT.deleteRow(Index)\n\n    }\n  }\n  \n}\n\n"}]}