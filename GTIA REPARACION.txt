{"files":[{"id":"c906bfd8-ec1d-4719-aaf8-262da695b82d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"QUITAR_FILA\",\n      \"functionName\": \"QUITAR_FILA\"\n    }, {\n      \"menuName\": \"GTIA_REP\",\n      \"functionName\": \"GTIA_REP\"\n    }]\n  }\n}"},{"id":"3d7a56f3-ca3f-4135-a11b-87d22b84cc9e","name":"CÃ³digo","type":"server_js","source":"function DIAS_USO()\n{ var DATA\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027DATA\u0027);\n  var ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n  var D_ST\u003dST.getDataRange().getValues()\n  var D_DATA\u003dDATA.getDataRange().getValues()\n\n  var Filtro\u003dD_ST.map(function (v,i){return [v[3],v[7],v[55],v[19],v[23],v[24],i+1]}).filter(function (v){return v[0]!\u003d\u003d\"\"\u0026\u0026v[1]!\u003d\u003d\"\"\u0026\u0026v[5]\u003d\u003d\u003d\"\"\u0026\u0026v[6]\u003e3\u0026\u0026v[3]!\u003d\u003d\"\"})\n\n  for(i\u003d0;i\u003cFiltro.length;i++)\n  { var SR\u003dFiltro[i][3].toString()\n    var Index1\u003dFiltro[i][6]\n    var FI\u003dFiltro[i][1].valueOf()/86400000\n    \n    var Filtro2\u003dD_ST.map(function (v,i){return [v[19],v[55],i+1]}).filter(function (v){return v[0].toString()\u003d\u003d\u003dSR\u0026\u0026v[2]\u003cIndex1})\n    Logger.log(\u0027F2\u003d\u0027+Filtro2)\n\n    if(Filtro2.length\u003d\u003d0)\n    {  var Filtro3\u003dD_DATA.filter(function (v){return v[1].toString()\u003d\u003d\u003dSR})\n       Logger.log(\u0027F3\u003d\u0027+Filtro3)\n       if(Filtro3.length\u003d\u003d0)\n       { var FA\u003dFiltro[i][4].valueOf()\n       // Logger.log(\u0027FA\u003d\u0027+FA)\n        if(FA\u003d\u003d\"N/A\"){ var Days\u003d\"N/A\"}\n       if(FA\u003d\u003d\"\"){ var Days\u003d\"\"}\n       if(FA\u003d\u003d\"NO APLICA\"){ var Days\u003d\"NO APLICA\"}\n       if(FA\u003e0)\n       { var FA\u003dFA/86400000\n         var Days\u003dFI-FA\n         Days\u003dDays.toFixed(0)\n       }\n       \n       ST.getRange(\u0027Y\u0027+Index1).setValue(Days)\n       }\n       else\n       { var L3\u003dFiltro3.length-1\n         FE\u003dFiltro3[L3][3].valueOf()\n         if(FE\u003e0)\n         {FE\u003dFE/86400000\n         var Days\u003dFI-FE\n         Days\u003dDays.valueOf().toFixed(0)\n         ST.getRange(\u0027Y\u0027+Index1).setValue(Days)\n         }\n       }\n    }\n    else \n    { var L2\u003dFiltro2.length-1\n         FE\u003dFiltro2[L2][1].valueOf()/86400000\n         var Days\u003dFI-FE\n         Days\u003dDays.valueOf().toFixed(0)\n         ST.getRange(\u0027Y\u0027+Index1).setValue(Days)\n    }\n    Logger.log(Days)\n  }\n\n}\n\nfunction VER_DIAS()\n{ var ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n  var D_ST\u003dST.getDataRange().getValues()\n\n  var Filtro\u003dD_ST.map(function (v,i){return [v[24],i+1]}).filter(function (v){return v[0]\u003e18000})\n\n  var L\u003dFiltro.length\n\n  for(i\u003d0;i\u003cL;i++)\n  { var Index\u003dFiltro[i][1]\n    ST.getRange(\u0027Y\u0027+Index).setValue(\"\")\n  }\n\n  Logger.log(L)\n\n}\n\n\nfunction GTIA_REP()\n{ var DATA\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027DATA\u0027);\n  var ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n\n  var D_ST\u003dST.getDataRange().getValues()\n  var D_DATA\u003dDATA.getDataRange().getValues()\n\n  var GTIA\u003dD_ST.map(function (v,i){return [v[3],v[7],v[55],v[19],v[28],i+1]}).filter(function (v){return v[4]\u003d\u003d\u003d\"\"\u0026\u0026v[0]!\u003d\u003d\"\"\u0026\u0026v[3]!\u003d\u003d\"\"\u0026\u0026v[5]\u003e3})\n\n  for(i\u003d0;i\u003cGTIA.length;i++)\n  { var SR\u003dGTIA[i][3].toString()\n    var STT\u003dGTIA[i][0].toString()\n    \n    Logger.log(\"ST\u003d\"+STT)\n    var Comp\u003dD_DATA.filter(function (v){return v[1]\u003d\u003d\u003dSR\u0026\u0026v[0].toString()!\u003d\u003dSTT})\n    Logger.log(\"Comp\u003d\"+Comp)\n\n    if(Comp.length\u003e0)\n    { var T\u003dComp.length-1\n      var FE\u003dComp[T][3].valueOf()/86400000\n      var FI\u003dGTIA[i][1].valueOf()/86400000\n\n      var RR\u003dFI-FE\n      Logger.log(\"RR\u003d\"+RR)\n      if((RR\u003c\u003d90)\u0026\u0026(FE\u003e0))\n      {ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"SI APLICA\")}\n      if((RR\u003e90)\u0026\u0026(FE\u003e0))\n      { ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"NO APLICA\")}\n    }\n\n    if(Comp.length\u003d\u003d0)\n    { var F\u003dGTIA[i][5]\n      var Comp2\u003dD_ST.map(function (v,i){return [v[3],v[7],v[55],v[19],v[28],i+1,v[42]]}).filter(function (v){return v[3]\u003d\u003d\u003dSR\u0026\u0026v[5].valueOf()\u003cF})\n      Logger.log(\"Comp2\u003d\"+Comp2)\n     \n      if(Comp2.length\u003e0)\n      { var T\u003dComp2.length-1\n        var APROB\u003dComp2[T][6]\n        if(APROB!\u003d\"NO APROBADO\") ////////////////////////////////////\u003c---------\n        {var FE\u003dComp2[T][2].valueOf()/86400000\n         var FI\u003dGTIA[i][1].valueOf()/86400000\n      Logger.log(\u0027FE\u003d\u0027+FE)\n      Logger.log(\u0027FI\u003d\u0027+FI)\n      if(FE\u003e0)\n      { RR\u003dFI-FE\n        if(RR\u003c\u003d90){ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"SI APLICA\")}\n        if(RR\u003e90){ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"NO APLICA\")}\n      }else \n       { RR\u003dFI-(Comp2[T][1].valueOf()/86400000)\n         Logger.log(\"RR2\u003d\"+RR)\n         if(RR\u003c\u003d90){ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"SI APLICA\")}\n         if(RR\u003e90){ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"NO APLICA\")}\n       }\n       }if(APROB\u003d\u003d\"NO APROBADO\"){ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"CASO ANTERIOR NO APROBADO\")}\n      }\n      if(Comp2.length\u003d\u003d0)\n      { ST.getRange(\u0027AC\u0027+GTIA[i][5]).setValue(\"NO APLICA\")}\n    }\n  }\n}\n\n  function TEC_REINGRESOS()\n  {\n    var ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n    var D_ST\u003dST.getDataRange().getValues()\n    var Hoja\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027REINGRESOS\u0027);\n\n    var Filtro\u003dD_ST.map(function (v,i){return [v[3],v[26],v[19],i+1,v[17]]}).filter(function (v){return v[1]\u003d\u003d\u003d\"SI APLICA\" })\n\n    Logger.log(Filtro)\n    var j\u003d2\n    for(i\u003d0;i\u003cFiltro.length;i++)\n    {\n      var SR\u003dFiltro[i][2]\n      var Index\u003dFiltro[i][3]\n      var SS\u003dFiltro[i][0]\n      var MM\u003dFiltro[i][4]\n      \n      if(SR!\u003d\"SERVICIO\")\n      {\n      var Filtro2\u003dD_ST.map(function (v,i){return [v[3],v[19],v[45],i+1]}).filter(function (v){return v[1]\u003d\u003d\u003dSR\u0026\u0026v[3]\u003cIndex})\n      \n      if(Filtro2.length\u003e0)\n       {var LL\u003dFiltro2.length-1\n        Hoja.getRange(\u0027A\u0027+j).setValue(SR)\n        Hoja.getRange(\u0027B\u0027+j).setValue(MM)\n        Hoja.getRange(\u0027C\u0027+j).setValue(SS)\n        Hoja.getRange(\u0027D\u0027+j).setValue(Filtro2[LL][0])\n        Hoja.getRange(\u0027E\u0027+j).setValue(Filtro2[LL][2])\n        \n        j\u003dj+1\n       }\n      }\n\n    }\n  }\n\nfunction QUITAR_FILA() \n{ var Hoja\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027DATA\u0027);\n  var Fecha\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027VAL\u0027).getRange(\u0027A5\u0027).getValue()\n  \n  var Ult\u003dHoja.getDataRange().getLastRow()\n  Logger.log(Ult)\n\n  for(i\u003d2;i\u003c\u003dUlt;i++)\n  {var Ing\u003dHoja.getRange(\u0027C\u0027+i).getValue()\n    if(Ing\u003cFecha)\n    { Logger.log(i)\n      Hoja.deleteRow(i)\n      Hoja.insertRowBefore(Ult)\n     i\u003di-1\n    }\n  }\n}\n"}]}