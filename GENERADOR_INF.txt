{"files":[{"id":"e11fb9c2-b6c5-43e9-b2b6-6fd0af48a54e","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"b64368a3-5e69-454d-8cae-640a5e5c039d","name":"CÃ³digo","type":"server_js","source":"function CLIENTES()\n{ var CLIENTES\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027D\u0027) //Clientes\n  var H_C\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027CLIENTES (DRIVE GESTION)\u0027)\n\nvar L_C\u003dCLIENTES.getDataRange().getLastRow()+10\n\nH_C.getRange(\u0027A2:A\u0027+L_C).setValues(CLIENTES.getRange(\u0027A2:A\u0027+L_C).getValues())\n\n}\n\nfunction INFORME() {\n  \n  var HINF\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GENERAL INGRESOS\u0027);\n  HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando\")\n  var CLIENT\u003dHINF.getRange(\u0027C1\u0027).getValue()\n\n  var Ult\u003dHINF.getDataRange().getLastRow()\n\n  SpreadsheetApp.flush()\n  if(Ult\u003e3)\n  { HINF.getRange(\u0027A4:AK\u0027+Ult).clearContent()\n    HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando.\")\n  }\n\n\n  var H_ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n  var D_ST\u003dH_ST.getDataRange().getValues()\n  HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando..\")\n\n  var Filtro\u003dD_ST.map(function (v,i) {return [v[0],v[3],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15],v[16],v[17],v[18],v[19],v[20],v[21],v[22],v[25],v[26],v[27],v[28],v[32],v[33],v[34],v[35],v[37],v[39],v[36],v[41],v[42],v[43],v[44],v[55],v[53],v[54]]}).filter(function (v){return v[2]\u003d\u003dCLIENT})\n  var L\u003d Filtro.length\n  var j\u003dL+3\n\n  HINF.getRange(\u0027A4:AK\u0027+j).setValues(Filtro)\n\n  HINF.getRange(\u0027F1\u0027).setValue(\"Finalizado\")\n\n}\n\n\nfunction INFORME2() {\n  \n  var HINF\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GENERAL INGRESOS (2)\u0027);\n  HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando\")\n  var CLIENT\u003dHINF.getRange(\u0027C1\u0027).getValue()\n\n  var Ult\u003dHINF.getDataRange().getLastRow()\n\n  SpreadsheetApp.flush()\n  if(Ult\u003e3)\n  { HINF.getRange(\u0027A4:AK\u0027+Ult).clearContent()\n    HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando.\")\n  }\n\n\n  var H_ST\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027GLOBAL\u0027)\n  var D_ST\u003dH_ST.getDataRange().getValues()\n  HINF.getRange(\u0027F1\u0027).setValue(\"Ejecutando..\")\n\n  var Filtro\u003dD_ST.map(function (v,i) {return [v[0],v[3],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15],v[16],v[17],v[18],v[19],v[20],v[21],v[22],v[25],v[26],v[27],v[28],v[32],v[33],v[34],v[35],v[37],v[39],v[36],v[41],v[42],v[43],v[44],v[55],v[53],v[54]]}).filter(function (v){return v[2]\u003d\u003dCLIENT})\n  var L\u003d Filtro.length\n  var j\u003dL+3\n\n  HINF.getRange(\u0027A4:AK\u0027+j).setValues(Filtro)\n\n  HINF.getRange(\u0027F1\u0027).setValue(\"Finalizado\")\n\n}\n\n\n"}]}