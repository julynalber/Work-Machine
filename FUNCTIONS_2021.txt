{"files":[{"id":"eb944ad6-76bb-4422-8fd0-d082c0df1e9d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"HHH\",\n      \"functionName\": \"HHH\"\n    }, {\n      \"menuName\": \"VALIDACION\",\n      \"functionName\": \"VALIDACION\"\n    }, {\n      \"menuName\": \"yyyy\",\n      \"functionName\": \"yyyy\"\n    }, {\n      \"menuName\": \"C_LINKS\",\n      \"functionName\": \"C_LINKS\"\n    }, {\n      \"menuName\": \"trerer\",\n      \"functionName\": \"trerer\"\n    }, {\n      \"menuName\": \"fdsfsfsf\",\n      \"functionName\": \"fdsfsfsf\"\n    }, {\n      \"menuName\": \"S_REP\",\n      \"functionName\": \"S_REP\"\n    }, {\n      \"menuName\": \"C_COT\",\n      \"functionName\": \"C_COT\",\n      \"defaultShortcut\": \"Ctrl+Alt+Shift+1\"\n    }, {\n      \"menuName\": \"sdsdj\",\n      \"functionName\": \"sdsdj\"\n    }, {\n      \"menuName\": \"DSDS\",\n      \"functionName\": \"DSDS\"\n    }, {\n      \"menuName\": \"HSSHHS\",\n      \"functionName\": \"HSSHHS\"\n    }, {\n      \"menuName\": \"ESTADO\",\n      \"functionName\": \"ESTADO\"\n    }, {\n      \"menuName\": \"SKSK\",\n      \"functionName\": \"SKSK\"\n    }, {\n      \"menuName\": \"jhk\",\n      \"functionName\": \"jhk\"\n    }, {\n      \"menuName\": \"HGHH\",\n      \"functionName\": \"HGHH\"\n    }, {\n      \"menuName\": \"SDSDSD\",\n      \"functionName\": \"SDSDSD\"\n    }, {\n      \"menuName\": \"fgdsgfdg\",\n      \"functionName\": \"fgdsgfdg\"\n    }, {\n      \"menuName\": \"fdsfsdf\",\n      \"functionName\": \"fdsfsdf\"\n    }, {\n      \"menuName\": \"LOTES\",\n      \"functionName\": \"LOTES\"\n    }]\n  }\n}"},{"id":"9bdd3c2a-da95-4bcc-bb1c-f674d76d71d0","name":"macros","type":"server_js","source":"function onEdit(e) {\n  if (e.source.getActiveSheet().getName() \u003d\u003d \"GLOBAL\") {\n    var F \u003d e.range.getRow()\n    var C \u003d e.range.getColumn()\n    var V \u003d e.value\n    var ST \u003d \"\"\n    var LIM \u003d 3\n\n       if ((C \u003d\u003d 30) \u0026\u0026 (V !\u003d null) \u0026\u0026 (F \u003e LIM))  //Estado ASIGNADO REVISIÓN\n    {\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AE\u0027 + F).setValue(new Date)\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"ASIGNADO REVISIÓN\")\n      return;\n    }\n\n    if ((C \u003d\u003d 49) \u0026\u0026 (V !\u003d null) \u0026\u0026 (F \u003e LIM))  //Estado ASIGNADO REPARACIÓN\n    {\n      if (V !\u003d \"N/A\") \n      {SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AX\u0027 + F).setValue(new Date)\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"ASIGNADO REPARACIÓN\") \n      }\n      return;\n    }\n\n    if ((C \u003d\u003d 48) \u0026\u0026 (V \u003e 0) \u0026\u0026 (F \u003e LIM))  //Estado PENDIENTE ASIGNACIÓN\n    {\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"PENDIENTE ASIGNACIÓN\")\n      return;\n    }\n    if ((C \u003d\u003d 48) \u0026\u0026 (V \u003d\u003d \"PENDIENTE\") \u0026\u0026 (F \u003e LIM))  //Estado PENDIENTE POR REPUESTOS\n    {\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"PENDIENTE POR REPUESTO\")\n      return;\n    }\n    if ((C \u003d\u003d 43) \u0026\u0026 (V \u003d\u003d \"APROBADO\") \u0026\u0026 (F \u003e LIM))  //Estado \n    {\n      var MO \u003d SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AL\u0027 + F).getValue()\n      var Rep \u003d SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AN\u0027 + F).getValue()\n      var Ped \u003d SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AS\u0027 + F).getValue()\n      if ((Rep \u003e 0) \u0026\u0026 (Ped !\u003d \"N/A\")) { SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"SOLICITAR REPUESTO\") }\n      if ((Rep \u003e 0) || (MO \u003e 0)) { SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027BE\u0027 + F).setValue(\"SOLICITAR FACTURA\") }\n      return;\n    }\n\n    if ((C \u003d\u003d 43) \u0026\u0026 (V \u003d\u003d \"NO APROBADO\") \u0026\u0026 (F \u003e LIM))  //Estado DEVOLVER SIN REPARAR\n    {\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AT\u0027 + F + \u0027:AY\u0027 + F).setValue(\"N/A\")\n      SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027BA\u0027 + F).setValue(\"NO APROBADO/ DEVOLUCIÓN SIN REPARAR\")\n      var MO \u003d SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027AL\u0027 + F).getValue()\n      if (MO \u003e 0) { SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"PENDIENTE OC\") }\n      else { SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"DEVOLUCIÓN SIN REPARAR\") }\n      return;\n    }\n    \n    \n    ////////////////\n    //\n    //\n    // if ((C \u003d\u003d 8) \u0026\u0026 (V !\u003d null) \u0026\u0026 (F \u003e LIM)) //Estado INGRESO\n    // {\n    //   SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"INGRESO\")\n    //   return;\n    // }\n    //\n    //\n    //if((C\u003d\u003d30)\u0026\u0026(V!\u003dnull)\u0026\u0026(F\u003eLIM))  //Estado DIAGNOSTICADO manual\n    // { SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027+F).setValue(\"DIAGNOSTICADO\")\n    //}\n    //\n    // if ((C \u003d\u003d 34) \u0026\u0026 (V !\u003d null) \u0026\u0026 (F \u003e LIM))  //Estado PENDIENTE DE APROBACIÓN\n    // {\n    //   SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"PENDIENTE DE APROBACIÓN\")\n    //   return;\n    // }\n    //\n    // if ((C \u003d\u003d 53) \u0026\u0026 (V !\u003d null)) {\n    //   SpreadsheetApp.getActiveSpreadsheet().getRange(\u0027A\u0027 + F).setValue(\"ENTREGADO\")\n    //   return;\n    // }\n  }\n}\n\nfunction DIAGNOSTIC() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var H_Diag \u003d SpreadsheetApp.openById(\"1MLR8RWJeSoBmIxpESLgtP3YZ29NmyvFjcz_I74wnoTc\").getSheetByName(\"Act Cerradas\")\n  var D_Hoja \u003d Hoja.getDataRange().getValues()\n  var D_Diag \u003d H_Diag.getDataRange().getValues()\n\n  var DD \u003d D_Hoja.map(function (v, i) { return [v[0], v[3], i + 1,v[31],v[32],v[29],v[30]] }).filter(function (v) { return v[0] !\u003d\u003d\"\"\u0026\u0026(v[3]\u003d\u003d\u003d\"\"||v[4]\u003d\u003d\u003d\"\"||v[5]\u003d\u003d\u003d\"\"||v[6]\u003d\u003d\u003d\"\") })    //v[0]!\u003d\u003d\"INGRESO\"\n  var D \u003d DD.length\n\n  for (i \u003d 0; i \u003c D; i++) \n  {\n    var ST \u003d DD[i][1].toString()\n    Logger.log(\"ST\u003d\" + ST)\n    var Comp \u003d D_Diag.map(function (v) { return [v[4], v[7].toString(), v[0], v[10], v[11], v[12], v[14],v[2],v[13]] }).filter(function (v) { return v[0] \u003d\u003d\u003d \"Revisión\" \u0026\u0026 v[1] \u003d\u003d\u003d ST \u0026\u0026 v[3] !\u003d\u003d \"N/A\" \u0026\u0026 v[4].toString().indexOf(\"N/A\", 0) \u003d\u003d\u003d -1 \u0026\u0026 v[5].toString().indexOf(\"N/A\", 0) \u003e -1 \u0026\u0026 v[6] !\u003d\u003d \"\"})\n    Logger.log(Comp)\n    if (Comp.length \u003d\u003d 1) \n    {\n      var Index \u003d DD[i][2]\n      var FF\u003dDD[i][3]\n      var D_D\u003dDD[i][4]\n      var TT\u003dDD[i][5]\n      if((FF\u003d\u003d\"\")||(D_D\u003d\u003d\"\"))\n      { var INFO \u003d Comp.map(function (v) { return [v[2], v[3], v[4],v[8]] })\n      if(TT!\u003dComp[0][7]){Hoja.getRange(\u0027AD\u0027+Index).setValue(Comp[0][7])} \n      Hoja.getRange(\u0027AF\u0027 + Index + \u0027:AI\u0027 + Index).setValues(INFO)\n      if(DD[i][0]\u003d\u003d\"ASIGNADO REVISIÓN\"){Hoja.getRange(\u0027A\u0027 + Index).setValue(\"DIAGNOSTICADO\")}\n      }\n      if(((FF\u003d\u003d\"\")||(TT\u003d\u003d\"\"))\u0026\u0026(D_D!\u003d\"\"))\n      {Hoja.getRange(\u0027AD\u0027+Index).setValue(Comp[0][7])\n      Hoja.getRange(\u0027AE\u0027 + Index+\u0027:AF\u0027+Index ).setValue(Comp[0][2])\n      }\n      \n    }\n  }\n }\n\n\nfunction SELLOS() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var H_Diag \u003d SpreadsheetApp.openById(\"1MLR8RWJeSoBmIxpESLgtP3YZ29NmyvFjcz_I74wnoTc\").getSheetByName(\"Act Cerradas\")\n  var D_Hoja \u003d Hoja.getDataRange().getValues()\n  var D_Diag \u003d H_Diag.getDataRange().getValues()\n\n  var SS \u003d D_Hoja.map(function (v, i) { return [v[0], v[3], i + 1,v[48],v[51],v[52],v[49]] }).filter(function (v) { return v[0] !\u003d\u003d \"\"\u0026\u0026v[0]!\u003d\u003d\"INGRESO\"\u0026\u0026(v[3]\u003d\u003d\u003d\"\"||v[4]\u003d\u003d\u003d\"\"||v[5]\u003d\u003d\u003d\"\"||v[6]\u003d\u003d\u003d\"\")})\n  var S \u003d SS.length\n\n Logger.log(\"S\u003d\"+S)\n  for (j \u003d 0; j \u003c S; j++) {\n    var ST2 \u003d SS[j][1].toString()\n    \n    var Comp2 \u003d D_Diag.map(function (v) { return [v[4], v[7].toString(), v[0], v[10], v[11], v[12], v[14],v[2]] })\n      .filter(function (v) { return v[0] \u003d\u003d\u003d \"Reparación\" \u0026\u0026 v[1] \u003d\u003d\u003d ST2 \u0026\u0026 v[3] !\u003d\u003d \"N/A\" \u0026\u0026 v[4].toString().indexOf(\"N/A\", 0) \u003e -1 \u0026\u0026 v[5].toString().indexOf(\"N/A\", 0) \u003d\u003d\u003d -1 \u0026\u0026 v[6] !\u003d\u003d \"\"; })\n    Logger.log(\"Comp2\u003d\" + Comp2)\n    if (Comp2.length \u003d\u003d 1) {\n      var Index2 \u003d SS[j][2]\n      var FF\u003dSS[j][4]\n      var S_S\u003dSS[j][5]\n      var TT\u003dSS[j][3].toString()\n      Logger.log(\"Index2\u003d \"+Index2)\n\n      if((S_S\u003d\u003d\"\")\u0026\u0026(FF\u003d\u003d\"\"))\n      { Logger.log(TT+\u0027\u003d\u0027+Comp2[0][7])\n        if(TT!\u003dComp2[0][7]){Hoja.getRange(\u0027AW\u0027+Index2).setValue(Comp2[0][7])}\n      var INFO2 \u003d Comp2.map(function (v) { return [v[2], v[5]] })\n            Hoja.getRange(\u0027AZ\u0027 + Index2 + \u0027:BA\u0027 + Index2).setValues(INFO2)\n        if(SS[j][0]!\u003d\"ENTREGADO\"){Hoja.getRange(\u0027A\u0027 + Index2).setValue(\"LISTO PARA ENTREGA\")}\n      }\n\n      if(TT\u003d\u003d\"\")\n      { var INFO3 \u003d Comp2.map(function (v) { return [v[7], v[2]] })\n      Hoja.getRange(\u0027AW\u0027+Index2+\u0027:AX\u0027+ Index2).setValues(INFO3)\n      }\n   }\n  }\n }\n\nfunction LOTES()\n{\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var D_Hoja \u003d Hoja.getDataRange().getValues()\n\n  var Filtro\u003dD_Hoja.map(function (v,i){return [v[3],v[4],v[6],v[7],i+1]}).filter(function (v){return v[0]!\u003d\u003d\"\"\u0026\u0026v[1]\u003d\u003d\u003d\"\"\u0026\u0026v[2]!\u003d\u003d\"\"\u0026\u0026v[3]!\u003d\u003d\"\"})\n\n  var L\u003dFiltro.length\n  Logger.log(\u0027Longitud\u003d \u0027+L)\n\n  var Ind_Fn\u003dFiltro[L-1][4]-1\n\n  while(D_Hoja[Ind_Fn][6]\u003d\u003dD_Hoja[Ind_Fn-1][6]){Ind_Fn--}\n\n  while(Filtro.length\u003e0)\n  {\n  var Client\u003dFiltro[0][2].toString()\n  var Fecha\u003dFiltro[0][3].toString()\n   \n  var Filtro2\u003dFiltro.filter(function (v){return v[2].toString()\u003d\u003d\u003dClient\u0026\u0026v[3].toString()\u003d\u003d\u003dFecha\u0026\u0026v[4]\u003c\u003dInd_Fn })\n  var LL\u003dFiltro2.length\n  Logger.log(Filtro2)\n\n  for(j\u003d1;j\u003c\u003dLL;j++)\n     { var Index\u003dFiltro2[j-1][4]\n       Hoja.getRange(\u0027E\u0027+Index).setValue(j+\u0027/\u0027+LL)\n     }\nvar D_Hoja \u003d Hoja.getDataRange().getValues()\nvar Filtro\u003dD_Hoja.map(function (v,i){return [v[3],v[4],v[6],v[7],i+1]}).filter(function (v){return v[0]!\u003d\u003d\"\"\u0026\u0026v[1]\u003d\u003d\u003d\"\"\u0026\u0026v[2]!\u003d\u003d\"\"\u0026\u0026v[3]!\u003d\u003d\"\"\u0026\u0026v[4]\u003c\u003dInd_Fn})\n  }\n\n}\n\nfunction COTIZADOR() {\n  \n  var GLOBAL\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var D_GLOBAL\u003dGLOBAL.getDataRange().getValues()\n  var COT\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027FORMATO\u0027);\n  COT.getRange(\u0027F1\u0027).setValue(\"Ejecutando\")\n\n  var Ult\u003dCOT.getRange(\u0027F500\u0027).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  var Ult_ST\u003dCOT.getRange(\u0027D500\u0027).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n\n  Logger.log(Ult)\n\n  COT.getRange(\u0027F1\u0027).setValue(\"Ejecutando.\")\n  if(Ult\u003e2)\n  { COT.getRange(\u0027A3:C\u0027+Ult).clearContent()\n    COT.getRange(\u0027E3:K\u0027+Ult).clearContent()\n  }\n  COT.getRange(\u0027F1\u0027).setValue(\"Ejecutando..\")\n  SpreadsheetApp.flush()\n\n  for(i\u003d3;i\u003c\u003dUlt_ST;i++)\n  { var ST\u003dCOT.getRange(\u0027D\u0027+i).getValue()\n    var L\u003dST.toString().length\n  COT.getRange(\u0027F1\u0027).setValue(\"Ejecutando...\")\n    if(L\u003e0)\n    {\n    var Filtro\u003dD_GLOBAL.map(function (v,i){return [v[25],v[28],v[34],v[3],v[17],v[19],v[20],v[21],v[22],v[32],v[33]]}).filter(function (v){return v[3]\u003d\u003d\u003dST})\n    \n     COT.getRange(\u0027A\u0027+i+\u0027:K\u0027+i).setValues(Filtro)\n    }\n  }\n  COT.getRange(\u0027F1\u0027).setValue(\"Finalizado\")\n}\n\n\nfunction NINGUNO() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var D_Hoja \u003d Hoja.getDataRange().getValues()\n\n  var Comp \u003d D_Hoja.map(function (v, i) { return [v[33].valueOf(), v[39].valueOf(), v[45], v[46], v[47], i + 1] }).filter(function (v) { return (v[0].toString().indexOf(\"ingun\", 0) \u003e -1 || v[0].toString().indexOf(\"requiere\", 0) \u003e -1) \u0026\u0026 (v[1] !\u003d\u003d 0 || v[2] !\u003d\u003d \"N/A\" || v[3] !\u003d\u003d \"N/A\" || v[4] !\u003d\u003d \"N/A\"); })\n  Logger.log(Comp)\n  for (i \u003d 0; i \u003c Comp.length; i++) {\n    var Index \u003d Comp[i][5]\n    Hoja.getRange(\u0027AH\u0027 + Index).setValue(\"Ninguno\")\n    Hoja.getRange(\u0027AM\u0027 + Index).setValue(\"USD\")\n    Hoja.getRange(\u0027AN\u0027 + Index).setValue(0)\n    Hoja.getRange(\u0027AT\u0027 + Index + \u0027:AV\u0027 + Index).setValue(\"N/A\")\n  }\n}\n\n\nfunction VALOR_MO() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var Data \u003d Hoja.getDataRange().getValues()\n  var Ult \u003d Hoja.getDataRange().getLastRow()\n\n  var Filtro \u003d Data.map(function (v, i) { return [v[25], v[37], i + 1] }).filter(function (v) { return v[0] \u003d\u003d\u003d \"VIGENTE\" \u0026\u0026 v[1] !\u003d\u003d 0 })\n\n  for (i \u003d 0; i \u003c Filtro.length; i++) {\n    var II \u003d Filtro[i][2]\n    Hoja.getRange(\u0027AL\u0027 + II).setValue(0)\n  } Logger.log(Filtro.length)\n}\n\nfunction FORZA_LISTOS() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var Data \u003d Hoja.getDataRange().getValues()\n\n  //Forzar Estado de Entregado\n\n  var Listos \u003d Data.map(function (v, i) { return [v[0],v[51],v[52],v[55], i + 1] }).filter(function (v) { return v[0] !\u003d\u003d \"LISTO PARA ENTREGA\"\u0026\u0026v[0]!\u003d\u003d\"DEVOLUCIÓN SIN REPARAR\"\u0026\u0026v[0]!\u003d\u003d\"PENDIENTE DE APROBACIÓN\"\u0026\u0026 v[1] !\u003d\u003d\"\"\u0026\u0026v[1]!\u003d\u003d\"N/A\" \u0026\u0026 v[2]!\u003d\u003d\"\"\u0026\u0026v[2]!\u003d\u003d\"N/A\"\u0026\u0026v[3]\u003d\u003d\u003d\"\" })\n\n  Logger.log(Listos)\n  Logger.log(Listos.length)\n\n  for (i \u003d 0; i \u003c Listos.length; i++) {\n    Index \u003d Listos[i][4]\n    Logger.log(Index)\n    Hoja.getRange(\u0027A\u0027 + Index).setValue(\"LISTO PARA ENTREGA\")\n  }\n}\n\n\nfunction FORZA_ENT() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var Data \u003d Hoja.getDataRange().getValues()\n\n  //Forzar Estado de Entregado\n\n  var Ent \u003d Data.map(function (v, i) { return [v[0], v[55], i + 1] }).filter(function (v) { return v[0] !\u003d\u003d \"ENTREGADO\" \u0026\u0026 v[1] !\u003d\u003d \u0027\u0027 \u0026\u0026 v[2] \u003e 3 })\n\n  Logger.log(Ent.length)\n\n  for (i \u003d 0; i \u003c Ent.length; i++) {\n    Index \u003d Ent[i][2]\n    Logger.log(Index)\n    Hoja.getRange(\u0027A\u0027 + Index).setValue(\"ENTREGADO\")\n  }\n}\n\nfunction FORZA_NO_APROB() {\n  var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var Data \u003d Hoja.getDataRange().getValues()\n\n  //Forzar sello \"devolución sin reparar\"\n\n  var No_aprob \u003d Data.map(function (v, i) { return [v[42],v[48],v[49],v[52], i + 1] }).filter(function (v) { return v[0]\u003d\u003d\u003d\"NO APROBADO\" \u0026\u0026 (v[1]\u003d\u003d\u003d\"\"||v[2]\u003d\u003d\u003d\"\"||v[3]\u003d\u003d\u003d\"\")\u0026\u0026v[4] \u003e 3 })\n\n  Logger.log(No_aprob.length)\n\n  for (i \u003d 0; i \u003c No_aprob.length; i++) {\n    Index \u003d No_aprob[i][4]\n    Logger.log(Index)\n    Hoja.getRange(\u0027AW\u0027 + Index+\u0027:AY\u0027+Index).setValue(\"N/A\")\n    Hoja.getRange(\u0027BA\u0027+Index).setValue(\"NO APROBADO/ DEVOLUCIÓN SIN REPARAR\")\n  }\n}\n\n  \nfunction CLEAR()\n{ var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027)\n  var Col\u003d[\u0027I\u0027,\u0027J\u0027,\u0027L\u0027,\u0027Q\u0027,\u0027S\u0027]\n  for(j\u003d0;j\u003c5;j++)\n  { var C\u003dCol[j]\n    var Formula\u003dHoja.getRange(C+\u0027:\u0027+C).getFormulas()\n    var Datos\u003dHoja.getRange(C+\u0027:\u0027+C).getValues()\n\n  var Valid\u003dDatos.map(function (v,i){return [v[0],Formula[i][0],i+1]}).filter(function(v){return v[0]!\u003d\u003d\"\"\u0026\u0026v[1]!\u003d\u003d\"\"\u0026\u0026v[2]\u003e3})\n\n  var L\u003dValid.length\n\n  for(i\u003d0;i\u003cL;i++)\n  {var II\u003dValid[i][2]\n   Hoja.getRange(C+II+\u0027:\u0027+C+II).setValue(Valid[i][0])\n  }\n }\n  var DD\u003dHoja.getRange(\u0027A:A\u0027).getValues()\n  var VV\u003dHoja.getRange(\u0027A:A\u0027).getDataValidations()\n\n  var LL\u003dDD.map(function (v,i){return [v[0],VV[i][0],i+1]}).filter(function (v){return v[0]\u003d\u003d\u003d\"ENTREGADO\"\u0026\u0026v[1]!\u003d\u003dnull\u0026\u0026v[2]\u003e3})\n\n  for(k\u003d0;k\u003cLL.length;k++)\n  { var II\u003dLL[k][2]\n    Hoja.getRange(II+\u0027:\u0027+II).clearDataValidations()\n  }\n\n  Logger.log(LL)\n\n\n}\n\n\n\n//////////////////////INCOMPLETOS/////////////////////////////////\n\n\n\n// function APROBACION_AUTO() {\n//   var Hoja \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n//   var D_Hoja \u003d Hoja.getDataRange().getValues()\n\n//   //Filtro de Garantia sin MO ni Repuestos\n//   var Filtro1 \u003d D_Hoja.map(function (v, i) { return [v[0], v[32], v[34], v[36], v[37], v[31], v[22], v[35], v[41], v[51], v[52], v[53], v[54], i + 1] }).filter(function (v) { return v[1] \u003d\u003d\u003d 0 \u0026\u0026 (v[2] \u003d\u003d\u003d 0 || v[8] \u003d\u003d\u003d \"N/A\") \u0026\u0026 v[6] \u003d\u003d\u003d \"VIGENTE\" \u0026\u0026 (v[3] \u003d\u003d\u003d \u0027\u0027 || v[4] \u003d\u003d\u003d \u0027\u0027 || v[7] \u003d\u003d\u003d \u0027\u0027 || v[9] \u003d\u003d\u003d \u0027\u0027 || v[10] \u003d\u003d\u003d \u0027\u0027 || v[11] \u003d\u003d\u003d \u0027\u0027 || v[12] \u003d\u003d\u003d \u0027\u0027) })\n\n//   Logger.log(Filtro1)\n\n\n//   for (i \u003d 0; i \u003c Filtro1.length; i++) {\n//     var Index \u003d Filtro1[i][13]\n//     var Est \u003d Filtro1[i][0]\n//     //Hoja.getRangeList([\u0027AK\u0027+Index,\u0027AM\u0027+Index]).setValue(Hoja.getRange(\u0027AF\u0027+Index).getValue())\n//     //Hoja.getRange(\u0027AL\u0027+Index).setValue(\"APROBADO\")\n//     //Hoja.getRangeList([\u0027AJ\u0027+Index,\u0027AN\u0027+Index,\u0027AZ\u0027+Index+\u0027:BC\u0027+Index]).setValue(\"N/A\")\n//     //if(Est!\u003d\"ENTREGADO\")\n//     //{ //Hoja.getRange(\u0027A\u0027+Index).setValue(\"PENDIENTE ASIGNACIÓN\")\n//     //}\n//   }\n//\n// }\n//\n// "},{"id":"2bf41b7f-faf7-4710-bba3-c715f98ad2a1","name":"macros_2.gs","type":"server_js","source":"function VER_ULEFONE()\n{ var GLOBAL\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var D_GLOBAL\u003dGLOBAL.getRange(\u0027R:T\u0027).getValues()\n  var C_GLOBAL\u003dGLOBAL.getRange(\u0027T:T\u0027).getBackgrounds()\n\n  var T_GLOBAL\u003dD_GLOBAL.map(function (v,i){return [v[0],v[1],v[2],C_GLOBAL[i].toString(),i+1]}).filter(function (v){return v[1]\u003d\u003d\u003d\"ULEFONE\"})\n\n  var Filtro\u003dT_GLOBAL.filter(function (v){return v[2].toString().length\u003c8\u0026\u0026v[3]!\u003d\u003d\"#fff2cc\"\u0026\u0026v[4]\u003e3})\n\n  for(i\u003d0;i\u003cFiltro.length;i++)\n  { var Index\u003dFiltro[i][4]\n    GLOBAL.getRange(\u0027T\u0027+Index).setBackground(\u0027#fff2cc\u0027)\n  }\n  \n  var Filtro2\u003dT_GLOBAL.filter(function (v){return v[2].toString().length\u003e7\u0026\u0026v[2].toString().length\u003c16\u0026\u0026v[3]!\u003d\u003d\"#b4a7d6\"\u0026\u0026v[4]\u003e3})\n  for(j\u003d0;j\u003cFiltro2.length;j++)\n  { var Index\u003dFiltro2[j][4]\n    GLOBAL.getRange(\u0027T\u0027+Index).setBackground(\u0027#b4a7d6\u0027)\n  }\n\n  var Filtro3\u003dT_GLOBAL.filter(function (v){return v[2].toString().length\u003e16\u0026\u0026v[3]!\u003d\u003d\"#d0e0e3\"\u0026\u0026v[4]\u003e3})\n\n   Logger.log(Filtro3)\n\n\n}"}]}