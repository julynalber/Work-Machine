{"files":[{"id":"cbed21ce-84d4-42ed-bf95-8f6d80e03e89","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"BORRA_PROTECT_FILA\",\n      \"functionName\": \"BORRA_PROTECT_FILA\"\n    }, {\n      \"menuName\": \"tststst\",\n      \"functionName\": \"tststst\"\n    }, {\n      \"menuName\": \"msdm\",\n      \"functionName\": \"msdm\"\n    }]\n  }\n}"},{"id":"62e8d73b-2bf8-48fb-a30b-ba9804e2b72c","name":"Código","type":"server_js","source":"function onEdit(e) \n{ if(e.source.getActiveSheet().getName()\u003d\u003d\"Actividades\")\n  { //SpreadsheetApp.getActiveSpreadsheet().toast(\"Prueba\",\"Aviso\",3)\n    var F\u003de.range.getRow()\n    var C\u003de.range.getColumn()\n    var V\u003de.value\n  \n      if((C\u003d\u003d20)\u0026\u0026(V!\u003dnull))\n    { var TS\u003dSpreadsheetApp.getActiveSheet().getRange(\u0027H\u0027+F).getValue()\n      if((TS\u003d\u003d\"Revisión\")||(TS\u003d\u003d\"Reparación\"))\n      { SpreadsheetApp.getActiveSheet().getRange(\u0027C\u0027+F).setValue(new Date)}\n      var PP\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"-\u003e\")\n      var FF\u003dPP.getRange(\u0027A500\u0027).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()+1\n      PP.getRange(\u0027A\u0027+FF).setValue(F)    \n    }\n\n    if((C\u003d\u003d8)\u0026\u0026(V!\u003dnull))\n      { if(V\u003d\u003d\u0027Revisión\u0027){SpreadsheetApp.getActiveSheet().getRange(\u0027R\u0027+F).setValue(\"N/A\")}\n        if(V\u003d\u003d\u0027Reparación\u0027){SpreadsheetApp.getActiveSheet().getRange(\u0027Q\u0027+F).setValue(\"N/A\")}\n        if(V\u003d\u003d\u0027Alistamiento\u0027){SpreadsheetApp.getActiveSheet().getRangeList([\u0027L\u0027+F,\u0027Q\u0027+F+\u0027:S\u0027+F]).setValue(\"N/A\")}\n        if(V\u003d\u003d\u0027Gestión soporte\u0027){SpreadsheetApp.getActiveSheet().getRangeList([\u0027L\u0027+F,\u0027Q\u0027+F+\u0027:S\u0027+F]).setValue(\"N/A\")}\n      }\n\n    // if((C\u003d\u003d17)\u0026\u0026(V!\u003dnull))\n    // { var TS\u003dSpreadsheetApp.getActiveSheet().getRange(\u0027H\u0027+F).getValue()\n    //   var Rep\u003dV.toString().indexOf(\"ingun\",0)\n    //  // SpreadsheetApp.getActiveSpreadsheet().toast(\"Si en la revisión se determina que no requiere repuestos se debe colocar Ninguno. No confundir con N/A\",\u0027Aviso\u0027,10);\n\n    //   if((TS\u003d\u003d\"Revisión\"))\n    //   { //SpreadsheetApp.getActiveSheet().getRange(\u0027C\u0027+F).setValue(new Date)\n    //     var PP\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"-\u003e\")\n    //     var FF\u003dPP.getRange(\u0027A1\u0027).getValue()\n    //     //PP.getRange(\u0027A\u0027+FF).setValue(F)      \n    //   }\n    // }\n\n  }\n}\n\nfunction MODELOS_CLIENTES()\n{ var CLIENTES\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027D\u0027) //Clientes\n  var MODELO\u003dSpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027C\u0027) //Modelos\n  var H_C\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Clientes\u0027)\n  var H_M\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Marca y Modelo\u0027)\n\nvar L_C\u003dCLIENTES.getDataRange().getLastRow()+5\nvar L_M\u003dMODELO.getDataRange().getLastRow()+5\n\nH_C.getRange(\u0027A2:A\u0027+L_C).setValues(CLIENTES.getRange(\u0027A2:A\u0027+L_C).getValues())\nH_M.getRange(\u0027A1:C\u0027+L_M).setValues(MODELO.getRange(\u0027A1:C\u0027+L_M).getValues())\n\n}\n\nfunction ORDENAR()\n{\n  var HAct\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Actividades\u0027)\n  var Ult\u003dHAct.getDataRange().getLastRow()\n  Logger.log(\"Ult\u003d\"+Ult)\n  var UU\u003dHAct.getRange(\u0027C\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()+1\n  Logger.log(\"UU\u003d\"+UU)\n  var VV\u003dHAct.getRange(\u0027O\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  var WW\u003dHAct.getRange(\u0027T\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  var Ind\u003d2\n  var FF\u003dUU-1\n \n /////// Hora Fin////////\n  if(HAct.getRange(\u0027T\u0027+Ind).isBlank()){}\n  else {Ind\u003dHAct.getRange(\u0027T1\u0027).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1}\n  Logger.log(Ind)\n  while(Ind\u003cWW)\n  { Logger.log(Ind)\n  if(HAct.getRange(\u0027T2\u0027).isBlank()){HAct.moveRows(HAct.getRange(\u00272:2\u0027),UU)}\n  else {Ind\u003dHAct.getRange(\u0027T1\u0027).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1\n  HAct.moveRows(HAct.getRange(Ind+\u0027:\u0027+Ind),UU)}\n  HAct.getRange(FF+\u0027:\u0027+FF).setBackground(\u0027#f4cccc\u0027);\n  WW\u003dHAct.getRange(\u0027T\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  Logger.log(\u0027WW\u003d\u0027+WW)\n }\n\n //////// Hora Inicio///////////\n Ind\u003d2\n  if(HAct.getRange(\u0027O\u0027+Ind).isBlank()){HAct.moveRows(HAct.getRange(\u00272:2\u0027),UU)}\n  else {Ind\u003dHAct.getRange(\u0027O1\u0027).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()}\n  VV\u003dHAct.getRange(\u0027O\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n while(Ind\u003cVV)\n {HAct.moveRows(HAct.getRange(VV+\u0027:\u0027+VV),Ind+1)\n  VV\u003dHAct.getRange(\u0027O\u0027+Ult).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  Ind\u003dHAct.getRange(\u0027O1\u0027).getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()\n  Logger.log(\u0027VV\u003d\u0027+VV)\n }\n\n// HAct.getRange(\u00272:\u0027+WW).sort([{column:3,ascending:true},{column:15,ascending:true}])\n    \n}\n\n\n\nfunction BORRA_PROTECT_TODO()\n{var ss \u003d SpreadsheetApp.getActive();\n var protections \u003d ss.getProtections(SpreadsheetApp.ProtectionType.RANGE);\n Logger.log(protections.length)\nfor (var i \u003d 0; i \u003c protections.length; i++) {\n  var protection \u003d protections[i];\n  Logger.log(protection)\n  if (protection.canEdit()) {\n    protection.remove();\n  }\n}\n\n}\n\nfunction BORRA_PROTECT_FILA()\n{var ss \u003d SpreadsheetApp.getActive();\n var Fila\u003dBrowser.inputBox(\u0027  Fila\u0027, \"\", Browser.Buttons.OK_CANCEL);\n var protections \u003d ss.getProtections(SpreadsheetApp.ProtectionType.RANGE);\n Logger.log(protections.length)\nfor (var i \u003d 0; i \u003c protections.length; i++) {\n  var protection \u003d protections[i];\n  var FF\u003dprotection.getRange().getA1Notation().indexOf(Fila,0)\n  if(FF\u003e-1)\n  { if (protection.canEdit()) {\n    protection.remove();\n     }\n  }\n}\n\n}\n\n/////////////////////////////////////////////\n\n\nfunction TIP()\n{ var ACT\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027Actividades\u0027)\n\n  var D_ACT\u003dACT.getDataRange().getValues()\n  \n  var Tip\u003dD_ACT.map(function (v,i){return [v[7],v[11],i+1]}).filter(function (v){return v[1]\u003d\u003d\u003d\"\"\u0026\u0026v[0]!\u003d\u003d\"Revisión\"\u0026\u0026v[0]!\u003d\u003d\"Reparación\"})\n\n  for(i\u003d0;i\u003cTip.length;i++)\n  { var Index\u003dTip[i][2]\n    ACT.getRange(\u0027L\u0027+Index).setValue(\"N/A\")\n\n  }\n\n\n}\n\n"}]}