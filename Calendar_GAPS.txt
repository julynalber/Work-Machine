{"files":[{"id":"395a25eb-caa0-4d8e-9112-cdcdbec30ba9","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Kolkata\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [{\n      \"userSymbol\": \"Calendar\",\n      \"serviceId\": \"calendar\",\n      \"version\": \"v3\"\n    }]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"380bf95e-6ea0-4d21-9924-fc198eb9e107","name":"Code","type":"server_js","source":"function getEvents() {\n\n  var ss \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var sheet \u003d ss.getSheetByName(\"Sheet1\");\n\n  var start_time \u003d sheet.getRange(\"A2\").getValue();\n  var end_time \u003d sheet.getRange(\"B2\").getValue();\n  var id_cal \u003d sheet.getRange(\"C2\").getValue();\n\n  var cal \u003d CalendarApp.getCalendarById(id_cal);\n    var events \u003d cal.getEvents(new Date(start_time), new Date(end_time));\n\n  for (var i \u003d 0;i\u003cevents.length;i++){\n    \n    var title \u003d  events[i].getTitle();\n    var start_time \u003d  events[i].getStartTime();\n    var end_time \u003d  events[i].getEndTime();\n    var loc \u003d events[i].getLocation();\n    var des \u003d  events[i].getDescription();\n    var vis \u003d events[i].getVisibility();\n    var CC \u003d events[i].getCreators();\n    var SS \u003d events[i].getMyStatus();\n\n    sheet.getRange(i+5,1).setValue(title);\n    sheet.getRange(i+5,2).setValue(start_time);\n    sheet.getRange(i+5,3).setValue(end_time);\n    sheet.getRange(i+5,4).setValue(CC);\n    sheet.getRange(i+5,5).setValue(des);\n    sheet.getRange(i+5,6).setValue(SS);\n    //sheet.getRange(i+5,7).setValue(CC);\n    //sheet.getRange(i+5,8).setValue(SS);\n  }\n\n  Logger.log(\"Events have been added to the Spreadsheet\");\n  \n}\n\n\nfunction create_Events(){\n\n  var ss \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var sheet \u003d ss.getSheetByName(\"Calendar_Events\");\n  var last_row \u003d sheet.getLastRow();\n  var data \u003d sheet.getRange(\"A1:E\" + last_row).getValues();\n  var cal \u003d CalendarApp.getCalendarById(\"aryanirani123@gmail.com\");\n  //Logger.log(data);\n  var event_status \u003d \u0027PRIVATE\u0027;\n\n  for(var i \u003d 0;i\u003c data.length;i++){\n    // index 0 \u003d Name of the Event \n    // index 1 \u003d Start Time of the Event\n    // index 2 \u003d End Time of the Event\n    // index 3 \u003d Location of the Event \n    // index 4 \u003d Description of the Event \n    // index 5 \u003d Attendess of the Event \n\n    var Events \u003d cal.createEvent(data[i][0],new Date(data[i][1]),new Date(data[i][2]),\n    {location: data[i][3], description : data[i][4]})\n    .setVisibility(CalendarApp.Visibility.PRIVATE);\n\n //Logger.log(\u0027Event ID: \u0027 + event.getId());\n\n  }  \n  Logger.log(\"Events have been added to the calendar\");\n\n}\n\nfunction createNewEventWithMeet() {\n\n  var ss \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var sheet \u003d ss.getSheetByName(\"Calendar_Events\");\n  var last_row \u003d sheet.getLastRow();\n  var data \u003d sheet.getRange(\"A2:E\" + last_row).getValues();\n  var cal \u003d CalendarApp.getCalendarById(\"aryanirani123@gmail.com\");\n\n  for(var i \u003d 0;i\u003c data.length;i++){\n\n    var event_name \u003d data[i][0];\n    var start_time \u003d data[i][1];\n    var end_time \u003d data[i][2];\n    var event_description \u003d data[i][3];\n    var attendees_event \u003d data[i][4];\n\n//.setVisibility(CalendarApp.Visibility.PRIVATE);\n\n  const gmt \u003d \"+05:30\";\n  const calendarId \u003d \"aryanirani123@gmail.com\";\n  const resource \u003d {\n    start: { dateTime: start_time+gmt },\n    end: { dateTime: end_time+gmt },\n    attendees: [{ email: attendees_event }],\n    conferenceData: {\n      createRequest: {\n        requestId: \"sample123\",\n        conferenceSolutionKey: { type: \"hangoutsMeet\" },\n      },\n    },\n    summary: event_name,\n    description: event_description,\n  };\n  const res \u003d Calendar.Events.insert(resource, calendarId, {\n    \n    conferenceDataVersion: 1,\n  });\n\n  \n  var googleMeet_Link \u003d res.hangoutLink;\n  \n  console.log(res);\n  }\n}\nfunction getmeet(){\n\n\n  var start_time \u003d \"7/1/2021 12:00 AM\";\n  var end_time \u003d \"7/20/2021 11:59 PM\";\n  var id_cal \u003d \"aryanirani123@gmail.com\";\n\n  var cal \u003d CalendarApp.getCalendarById(\"aryanirani123@gmail.com\");\n  var events \u003d cal.getEvents(new Date(start_time), new Date(end_time));\n\n\n\n\n\n\n}\n\n\n\n\n"}]}