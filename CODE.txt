{"files":[{"id":"69dadf52-908c-4e52-af23-a59905f0cd7d","name":"Código","type":"server_js","source":"function REGIST() \n{\nvar HC\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027ACT\u0027);\nvar HR\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027REGISTRO\u0027);\nvar Ult\u003dHC.getDataRange().getLastRow();\nvar U\u003dHR.getRange(\"D1\").getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1;\n\nvar D\u003dnew Date();\n\nvar DD\u003dD.getDate();\nvar MM\u003dD.getMonth()+1;\nvar Y\u003dD.getFullYear();\n\nvar HH\u003dD.getHours()-1; \nvar mm\u003dD.getMinutes()+1; \n\n//SpreadsheetApp.getActiveSpreadsheet().toast(U,\u0027Prueba\u0027,6);\n\nfor(var i\u003d2;i\u003c\u003dUlt;i++)\n{var V\u003dHC.getRange(i,5).getValue();\n  if(V\u003d\u003d\"X\")\n   {\n    HR.getRange(U,1).setValue(DD+\u0027/\u0027+MM+\u0027/\u0027+Y).setNumberFormat(\u0027dd/MM/yyyy\u0027);\n    HR.getRange(U,2).setValue(HH+\u0027:\u0027+mm).setNumberFormat(\u0027hh:mm\u0027);\n    HR.getRange(U,4).setValue(HC.getRange(i,1).getValue());\n    HR.getRange(U,5).setValue(HC.getRange(i,2).getValue());\n    HR.getRange(U,6).setValue(HC.getRange(i,3).getValue());\n    \n    var Act1\u003dHR.getRange(U-1,4).getValue();\n    var Act2\u003dHR.getRange(U-1,5).getValue();\n    var Act3\u003dHR.getRange(U-1,6).getValue();\n    var Act\u003dAct1+\u0027 - \u0027+Act2+\u0027 - \u0027+Act3;;\n    var Seg\u003d Browser.inputBox(\u0027Seguimiento\u0027, Act, Browser.Buttons.OK_CANCEL);\n    HR.getRange(U-1,7).setValue(Seg)\n    \n   }\n }\n}\n\nfunction START()\n{\nvar HR\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027REGISTRO\u0027);\nvar U\u003dHR.getRange(\"D1\").getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1;\nvar D\u003dnew Date();\nvar DD\u003dD.getDate();\nvar MM\u003dD.getMonth()+1;\nvar Y\u003dD.getFullYear();\nvar HH\u003dD.getHours()-1; \nvar mm\u003dD.getMinutes()+1; \n\nHR.getRange(U,1).setValue(DD+\u0027/\u0027+MM+\u0027/\u0027+Y).setNumberFormat(\u0027dd/MM/yyyy\u0027);\nHR.getRange(U,2).setValue(HH+\u0027:\u0027+mm).setNumberFormat(\u0027hh:mm\u0027);\nHR.getRange(U,4).setValue(\"INICIO JORNADA\");\nHR.getRange(U,5).setValue(\"INICIO JORNADA\");\nHR.getRange(U,6).setValue(\"INICIO JORNADA\");\n\n}\n\nfunction LUNCH()\n{\nvar HR\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027REGISTRO\u0027);\nvar U\u003dHR.getRange(\"D1\").getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1;\nvar D\u003dnew Date();\nvar DD\u003dD.getDate();\nvar MM\u003dD.getMonth()+1;\nvar Y\u003dD.getFullYear();\nvar HH\u003dD.getHours()-1; \nvar mm\u003dD.getMinutes()+1; \n\nHR.getRange(U,1).setValue(DD+\u0027/\u0027+MM+\u0027/\u0027+Y).setNumberFormat(\u0027dd/MM/yyyy\u0027);\nHR.getRange(U,2).setValue(HH+\u0027:\u0027+mm).setNumberFormat(\u0027hh:mm\u0027);\nHR.getRange(U,4).setValue(\"HORA ALMUERZO\");\nHR.getRange(U,5).setValue(\"HORA ALMUERZO\");\nHR.getRange(U,6).setValue(\"HORA ALMUERZO\");\n\n}\n\nfunction END()\n{\nvar HR\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027REGISTRO\u0027);\nvar U\u003dHR.getRange(\"D1\").getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1;\nvar D\u003dnew Date();\nvar DD\u003dD.getDate();\nvar MM\u003dD.getMonth()+1;\nvar Y\u003dD.getFullYear();\nvar HH\u003dD.getHours()-1; \nvar mm\u003dD.getMinutes()+1; \n\nHR.getRange(U,1).setValue(DD+\u0027/\u0027+MM+\u0027/\u0027+Y).setNumberFormat(\u0027dd/MM/yyyy\u0027);\nHR.getRange(U,2).setValue(HH+\u0027:\u0027+mm).setNumberFormat(\u0027hh:mm\u0027);\nHR.getRange(U,4).setValue(\"FIN JORNADA\");\nHR.getRange(U,5).setValue(\"FIN JORNADA\");\nHR.getRange(U,6).setValue(\"FIN JORNADA\");\n\n}\n\n//❤❤❤❤❤❤❤❤❤❤❤❤❤❤❤\n//SI(CONTAR.SI(E:E;\"X\")\u003d2;FALSO;VERDADERO)\n//Y(SI(CONTAR.SI(E:E;\"X\")\u003d2;FALSO;VERDADERO);SI(CONTAR.SI(D2:F2;\"X\")\u003d2;FALSO;VERDADERO))"},{"id":"eabc1f3a-80d9-4542-a6bc-745a606acaef","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Indiana/Indianapolis\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"SYSYS\",\n      \"functionName\": \"SYSYS\"\n    }]\n  }\n}"},{"id":"303cbe19-dd76-425c-9919-23279c408b1d","name":"macros","type":"server_js","source":"function SYSYS() {\n  var spreadsheet \u003d SpreadsheetApp.getActive();\n  spreadsheet.getRange(\u0027A2\u0027).activate()\n  .setValue(\u002743669\u0027);\n  spreadsheet.getRange(\u0027A:A\u0027).activate();\n  spreadsheet.getActiveRangeList().setNumberFormat(\u0027d/MM/yyyy\u0027);\n};"}]}