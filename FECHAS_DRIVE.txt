{"files":[{"id":"486ac6c9-ace1-4f10-8ffa-82cb786c0118","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"0c277e77-4f58-4f29-b2e1-853c7a83379c","name":"Código","type":"server_js","source":"//1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\n\nfunction FECHAS()\n{ var Hoja\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027FECHAS\u0027);\n  var D_Hoja\u003dHoja.getDataRange().getValues()\n  var Ult\u003dHoja.getDataRange().getLastRow()\n\n  var HH \u003d SpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\"GLOBAL\")\n  var D_HH\u003dHH.getRange(\u0027D:D\u0027).getValues()\n\n  var EST\u003dHoja.getRange(\u0027D1\u0027).getValue()\n  var ENC\u003dHoja.getRange(\u0027E1\u0027).getValue()\n\n  var F\u003dUlt-3\n\n  if(F\u003e0)\n  { for(i\u003d0;i\u003cF;i++)\n    { var j\u003di+3\n      var k\u003di+4\n      var ST\u003dD_Hoja[j][0]\n      var FF\u003dD_Hoja[j][1]\n      var Y\u003dFF.toString().indexOf(\"2021\",0)\n      \n      if((ST!\u003d\"\")\u0026\u0026(Y\u003c0))\n      { Hoja.getRange(\u0027C\u0027+k).setValue(\"X\")\n        Hoja.getRange(\u0027D\u0027+k).setValue(\"La fecha no corresponde al 2021\")\n      }\n\n      if((ST!\u003d\"\")\u0026\u0026(Y\u003e0))\n      { var Filtro\u003dD_HH.map(function (v,i){return [v[0],i+1]}).filter(function (v){return v[0]\u003d\u003d\u003dST})\n       \n       if(Filtro.length\u003d\u003d0)\n       { Hoja.getRange(\u0027C\u0027+k).setValue(\"X\")\n         Hoja.getRange(\u0027D\u0027+k).setValue(\"El caso o servicio no fue encontrado\")\n       }\n       if(Filtro.length\u003d\u003d1)\n       { var Index\u003dFiltro[0][1]\n         //Logger.log(\"Index\u003d\"+Index)\n         HH.getRange(\u0027A\u0027+Index).setValue(EST)\n         HH.getRange(ENC+Index).setValue(FF)\n\n         if(EST\u003d\u003d\"DEVOLUCIÓN SIN REPARAR\")\n         {HH.getRange(\u0027AL\u0027+Index).setValue(\"NO APROBADO\")           \n         }\n         Hoja.getRange(\u0027C\u0027+k).setValue(\"OK\")\n       }\n      }\n      SpreadsheetApp.flush()\n    }\n\n  }\n}\n"}]}