{"files":[{"id":"6923a5b8-9a8a-4880-bbf9-1311d0b9895e","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Indiana/Indianapolis\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"TTT\",\n      \"functionName\": \"TTT\"\n    }, {\n      \"menuName\": \"C_DIAG\",\n      \"functionName\": \"C_DIAG\"\n    }, {\n      \"menuName\": \"prueba\",\n      \"functionName\": \"prueba\"\n    }, {\n      \"menuName\": \"pp\",\n      \"functionName\": \"pp\"\n    }, {\n      \"menuName\": \"ttt\",\n      \"functionName\": \"ttt\"\n    }, {\n      \"menuName\": \"yyay\",\n      \"functionName\": \"yyay\"\n    }]\n  }\n}"},{"id":"82c04334-8a37-48eb-854f-930cd6ed2482","name":"macros","type":"server_js","source":"\n//FUNCION CORREO DE DIAGNOSTICO\n   \n function C_DIAG()\n{ var Servicio\u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var p\u003dServicio.getRange(\"R3\").activateAsCurrentCell().getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1\n  var ult\u003d Servicio.getDataRange().getLastRow()\n  var u\u003dServicio.getRange(\"K\"+ult).activateAsCurrentCell().getNextDataCell(SpreadsheetApp.Direction.UP).getRow() \n \n  \n  for(var i\u003dp;i\u003c\u003du;i++)\n  { var j\u003di-1\n    var Celdaact\u003d Servicio.getRange(\u0027K\u0027+i).getValue();\n    var Celdaant\u003d Servicio.getRange(\u0027K\u0027+j).getValue();\n    if (Celdaant\u003d\u003dCeldaact)\n        { Servicio.getRange(\u0027R\u0027+i).setValue(Servicio.getRange(\u0027R\u0027+j).getValue())\n          Servicio.getRange(\u0027S\u0027+i).setValue(Servicio.getRange(\u0027S\u0027+j).getValue())\n      }\n    else\n        {if(Celdaact.length\u003e0){ \n          var Asunto\u003d Celdaact+\" DIAGNOSTICADO\";\n          var C\u003dGmailApp.search(\u0027subject:\u0027+Asunto)\n           if(C.length\u003e0)\n             { var M\u003dC[0].getMessages()\n               var D\u003dM[0].getDate()  \n               Servicio.getRange(\u0027R\u0027+i).setValue(D) //Retorna dia\n               var F\u003dM[0].getFrom()\n               var l\u003dF.indexOf(\"@\")\n               var b\u003dF.indexOf(\"\u003c\")\n               var T\u003dF.slice(b+1,l)\n               var Tec\u003dCORREO(T); \n               Servicio.getRange(\u0027S\u0027+i).setValue(Tec) //Retorna tecnico\n               }\n             }\n       }\n   }\n }   \n  \n  \n  function C_REP()\n{ var Hoja\u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027);\n  var p\u003dHoja.getRange(\"AJ3\").activateAsCurrentCell().getNextDataCell(SpreadsheetApp.Direction.DOWN).getRow()+1;\n  var ult\u003d Hoja.getDataRange().getLastRow();\n  var u\u003dHoja.getRange(\"K\"+ult).activateAsCurrentCell().getNextDataCell(SpreadsheetApp.Direction.UP).getRow(); \n \n   \n   for(var i\u003dp;i\u003c\u003du;i++)\n  { var Estado\u003d Hoja.getRange(\u0027Y\u0027+i).getValue()\n       if(Estado\u003d\u003d\"APROBADO\")\n        { var Servicio\u003dHoja.getRange(\u0027K\u0027+i).getValue();\n          if(Servicio.length\u003e0)\n          { var Serial\u003dHoja.getRange(\u0027O\u0027+i).getValue();\n            var Asunto\u003d Servicio+\" REPARADO \"+Serial;\n            var C\u003dGmailApp.search(\u0027subject:\u0027+Asunto)\n            if(C.length\u003e0)\n             { var M\u003dC[0].getMessages()\n               var D\u003dM[0].getDate()  \n               Hoja.getRange(\u0027AJ\u0027+i).setValue(D) //Retorna dia\n               var F\u003dM[0].getFrom()\n               var l\u003dF.indexOf(\"@\")\n               var b\u003dF.indexOf(\"\u003c\")\n               var T\u003dF.slice(b+1,l)\n               var Tec\u003dCORREO(T); \n               Hoja.getRange(\u0027AK\u0027+i).setValue(Tec)\n              \n             }\n          }\n       }\n       if(Estado\u003d\u003d\"NO APROBADO\")\n        { Hoja.getRange(\u0027AJ\u0027+i).setValue(\u0027N/A\u0027);\n         }\n       }\n   }\n      \n\n   \n   "}]}