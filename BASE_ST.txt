{"files":[{"id":"5daa2575-c3fe-4fba-b6c0-067cac675f9f","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n    \"libraries\": [{\n      \"userSymbol\": \"ADDONS_WM\",\n      \"libraryId\": \"1HWmIkt8Zbf_ob-mtzuUPl6VPWAdT8Mi_yTKj1YJpllilX2xC3vb5RKM7\",\n      \"version\": \"0\",\n      \"developmentMode\": true\n    }]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"sheets\": {\n    \"macros\": [{\n      \"menuName\": \"SJJSJSJ\",\n      \"functionName\": \"SJJSJSJ\"\n    }, {\n      \"menuName\": \"ssdsdsd\",\n      \"functionName\": \"ssdsdsd\"\n    }, {\n      \"menuName\": \"sddsdsd\",\n      \"functionName\": \"sddsdsd\"\n    }, {\n      \"menuName\": \"dsdsdsd\",\n      \"functionName\": \"dsdsdsd\"\n    }, {\n      \"menuName\": \"ORDENAR\",\n      \"functionName\": \"ORDENAR\"\n    }]\n  }\n}"},{"id":"a44020b5-d061-45fe-977b-c497b2533250","name":"Código","type":"server_js","source":"function RECOLECT()\n{ var H_INT \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027INTERCONEXIÒN\u0027).getRange(\u0027B1:B4\u0027).getValues()\n  var DB_F\u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027BASE ACTIVIDADES\u0027)\n  \n  for(i\u003d0;i\u003c\u003d3;i++)\n  { var U\u003dDB_F.getDataRange().getLastRow()+1\n    var ID\u003dH_INT[i][0]\n    var DB \u003d SpreadsheetApp.openById(ID).getSheetByName(\u0027DB\u0027)\n    var D_DB\u003dDB.getDataRange().getValues()\n  \n    var Filtro\u003dD_DB.filter(function (v,i){return v[18]!\u003d\u003d\"\"\u0026\u0026v[1]!\u003d\u003d\u0027X\u0027\u0026\u0026i\u003e0})\n    var L\u003dFiltro.length\n    var M\u003dU+L-1\n    if(L\u003e0)\n    { var Data\u003dFiltro.map(function (v){return [v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15],v[16],v[17],v[18]]})\n       Logger.log(Filtro)\n      DB_F.getRange(\u0027A\u0027+U+\u0027:Q\u0027+M).setValues(Data)\n\n      SpreadsheetApp.flush()\n\n      var Filtro2\u003dD_DB.map(function (v,i){return [v[18],i+1]}).filter(function (v){return v[0]!\u003d\u003d\"\"\u0026\u0026v[1]\u003e1})\n      for(j\u003d0;j\u003cFiltro2.length;j++)\n      { var Index\u003dFiltro2[j][1]\n        DB.getRange(\u0027B\u0027+Index).setValue(\u0027X\u0027)\n\n      }\n    }  \n  }\n}\n\nfunction VERIFIC()\n{ var BA\u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027BASE ACTIVIDADES\u0027)\n  var Ult\u003dBA.getDataRange().getLastRow()+10\n\n  BA.getRange(\u00272:\u0027+Ult).sort([{column: 1, ascending: true}, {column: 3, ascending: true}, {column: 10, ascending: true}])\n\n\n  var D_BA\u003d BA.getDataRange().getValues()\n  var Filtro\u003dD_BA.map(function (v,i){return [v[0].valueOf(),v[2],v[4],v[7],v[9].valueOf(),v[16].valueOf(),\u0027\u0027,i+1]})\n\n  Logger.log(Filtro.length)\n\n  Filtro.forEach(function (v,i,A)\n  { if(i\u003d\u003d0){var Ant\u003dA[i]}\n    else{if((A[i-1][1]\u003d\u003dA[i][1])\u0026\u0026(A[i-1][2]\u003d\u003dA[i][2])\u0026\u0026(A[i-1][3]\u003d\u003dA[i][3])\u0026\u0026(A[i-1][4]\u003d\u003dA[i][4])\u0026\u0026(A[i-1][5]\u003d\u003dA[i][5])){A[i][6]\u003d\"ALV\"} }\n  })\n\n var Filtro2\u003dFiltro.filter(function (v){return v[6]\u003d\u003d\u003d\"ALV\"})\n\n for(i\u003dFiltro2.length-1;i\u003e\u003d0;i--)\n { var Index\u003dFiltro2[i][7]\n   Logger.log(Index)\n   BA.deleteRow(Index)\n\n }\n\n}\n\n"},{"id":"e8974343-e081-42ff-9c19-db957fd40846","name":"macros","type":"server_js","source":"function sddsdsd() {\n  var spreadsheet \u003d SpreadsheetApp.getActive();\r\n  spreadsheet.getRange(\u0027J3:J9911\u0027).activate();\r\n};\n\nfunction dsdsdsd() {\n  var spreadsheet \u003d SpreadsheetApp.getActive();\r\n  spreadsheet.getRangeList([\u0027J4:J9911\u0027, \u0027J2\u0027, \u0027J5\u0027]).activate();\r\n  spreadsheet.getCurrentCell().setValue(\u0027TRUE\u0027);\r\n  spreadsheet.getRangeList([\u0027J2\u0027, \u0027J6:J9911\u0027, \u0027J4\u0027]).activate();\r\n};\n\nfunction ORDENAR() {\n  var spreadsheet \u003d SpreadsheetApp.getActive();\r\n  var sheet \u003d spreadsheet.getActiveSheet();\r\n  sheet.getRange(1, 1, sheet.getMaxRows(), sheet.getMaxColumns()).activate();\r\n  spreadsheet.getActiveRange().offset(1, 0, spreadsheet.getActiveRange().getNumRows() - 1).sort([{column: 1, ascending: true}, {column: 3, ascending: true}, {column: 10, ascending: true}]);\r\n};"}]}