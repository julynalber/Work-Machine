{"files":[{"id":"b97d8f62-01fb-4d90-a896-677a6c025b97","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"7991e724-e88e-4b8c-9e27-7a0b9d3fd676","name":"CÃ³digo","type":"server_js","source":"function COPY()\n{ var Hoja \u003d SpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\"GLOBAL\")\n  var U\u003dHoja.getDataRange().getLastRow()\n  var LR\u003dHoja.getRange(\u0027D\u0027+U).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  var LC\u003dHoja.getDataRange().getLastColumn()\n  var DD\u003dHoja.getRange(1,1,LR,LC).getValues()\n  \n  var HH \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027)\n  HH.getRange(1,1,LR,LC).setValues(DD)\n  \n}\n\nfunction NEW_COPY()\n{ var Hoja \u003d SpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\"GLOBAL\")\n  var U\u003dHoja.getDataRange().getLastRow()\n  var LR\u003dHoja.getRange(\u0027D\u0027+U).getNextDataCell(SpreadsheetApp.Direction.UP).getRow()\n  var LC\u003dHoja.getDataRange().getLastColumn()\n  var DD\u003dHoja.getRange(1,1,LR,LC).getValues()\n\n  var Ind\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027).getRange(\u0027B1\u0027).getValue()\n  var Min\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027).getRange(\u0027B4\u0027).getValue()\n  var Lote\u003dSpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027).getRange(\u0027B3\u0027).getValue()\n\n  Logger.log(DD.length)\n\n  if(Ind\u003c0){Ind\u003d28}\n\n  while ((Ind\u003eMin)\u0026\u0026(DD.length\u003eLote))\n   { var Ind2\u003dInd-Lote\n    var Data\u003dDD.splice(Ind2-1,Lote)\n\n    SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027).getRange(\u0027B1\u0027).setValue(Ind2)\n    Ind\u003dInd2\n    \n    SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027GLOBAL\u0027).getRange(Ind2,1,Lote,LC).setValues(Data)\n\n    SpreadsheetApp.flush()\n\n    Logger.log(DD.length)\n    Logger.log(Data.length)\n\n   }\n\n  SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027).getRange(\u0027B1\u0027).setValue(LR) \n\n}\n\nfunction MOD_CLIENT()\n{ \n  var CLIENTES \u003d SpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027D\u0027) //Clientes\n  var MODELO \u003d SpreadsheetApp.openById(\"1CGx8qzzzq1k4kGK0tLT5A3qzgbThyyVB2uk7ayvbv0Q\").getSheetByName(\u0027C\u0027) //Modelos\n  var H_C \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027CLIENTES\u0027)\n  var H_M \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027MODELOS\u0027)\n  var IND \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027)\n\n  var CM\u003dMODELO.getRange(\u0027A33\u0027).getBackground()\n  var CC\u003dCLIENTES.getRange(\u0027A33\u0027).getBackground()\n\n  Logger.log(CM)\n\n  if(CC\u003d\u003d\u0027#ffff00\u0027)\n  { var L_C \u003d CLIENTES.getDataRange().getLastRow() + 5\n    H_C.getRange(\u0027A2:A\u0027 + L_C).setValues(CLIENTES.getRange(\u0027A2:A\u0027 + L_C).getValues())\n    CLIENTES.getRange(\u0027A33\u0027).setBackground(\u0027white\u0027)\n    IND.getRange(\u0027B6\u0027).setValue(1)\n\n  }\n\n  if(CM\u003d\u003d\u0027#ffff00\u0027)\n  { var L_M \u003d MODELO.getDataRange().getLastRow() + 5\n  H_M.getRange(\u0027A1:C\u0027 + L_M).setValues(MODELO.getRange(\u0027A1:C\u0027 + L_M).getValues())\n  MODELO.getRange(\u0027A33\u0027).setBackground(\u0027white\u0027)\n  IND.getRange(\u0027B7\u0027).setValue(1)\n  }\n}\n\nfunction INY_MOD_CLIENT()\n{ var IND \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027IND\u0027)\n  var CC\u003dIND.getRange(\u0027B6\u0027).getValue()\n  var CM\u003dIND.getRange(\u0027B7\u0027).getValue()\n\n  var ID \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027ID\u0027).getRange(\u0027A1:A5\u0027).getValues()\n\n  if(CC\u003d\u003d1)\n  { var H_C \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027CLIENTES\u0027)\n    var D_HC\u003dH_C.getDataRange().getValues()\n    var U_C\u003dH_C.getDataRange().getLastRow()\n    for(i\u003d0;i\u003c5;i++)\n    { SpreadsheetApp.openById(ID[i]).getSheetByName(\u0027CLIENTES\u0027).getRange(\u0027A:A\u0027).clearContent()\n      SpreadsheetApp.flush()\n      SpreadsheetApp.openById(ID[i]).getSheetByName(\u0027CLIENTES\u0027).getRange(\u0027A1:A\u0027+U_C).setValues(D_HC)\n      IND.getRange(\u0027B6\u0027).setValue(0)\n\n    }\n\n  }\n  if(CM\u003d\u003d1)\n  { var H_M \u003d SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\u0027MODELOS\u0027)\n    var D_HM\u003dH_M.getDataRange().getValues()\n    var U_M\u003dH_M.getDataRange().getLastRow()\n    for(i\u003d0;i\u003c5;i++)\n    { SpreadsheetApp.openById(ID[i]).getSheetByName(\u0027MODELOS\u0027).getRange(\u0027A:C\u0027).clearContent()\n      SpreadsheetApp.flush()\n      SpreadsheetApp.openById(ID[i]).getSheetByName(\u0027MODELOS\u0027).getRange(\u0027A1:C\u0027+U_M).setValues(D_HM)\n      IND.getRange(\u0027B7\u0027).setValue(0)\n    }\n\n  }\n\n}\n\n\n\n"}]}